import{T as a}from"./TelegramPlane-69e04bae-5d40d8f.js";import{d as e,b as t,aS as s,af as l,ab as o,l as n,r,A as i,aH as u,aT as c,k as m,o as d,h as p,b1 as f,b2 as h,a_ as v,F as w,b6 as x,bs as y,b5 as b}from"./vendor-8847080f-5d40d8f.js";import{H as g}from"./rounded-button-19d0a7c6-5d40d8f.js";import{h as k,S,R as C,a as j,d as P}from"./index-5d40d8f.js";import{u as T}from"./use-parse-payload-59b9c14d-5d40d8f.js";const H={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 12 12"},I=l("g",{fill:"none"},[l("path",{d:"M3 1a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2v1.5a.5.5 0 0 0 .777.416L6.651 9H9a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H3z",fill:"currentColor"})],-1);var L=e({name:"Comment12Filled",render:function(a,e){return t(),s("svg",H,[I])}});const R=e({setup(){const e=o(),t=n(),s=r({});i((()=>{k([S.原创,S.哲学,S.文学,S.诗词]).then((a=>{s.value={source:a.from,text:a.hitokoto,author:a.from_who||a.creator}}))}));const l=u(),H=async()=>{const a=async()=>{await C.api.says.post({data:s.value}),message.success("发布成功"),t.push({name:P.ListSay})};I.text||I.author||I.source?l.create({title:"警告",content:"发布一言会覆盖现有的内容, 要继续吗",type:"warning",negativeText:"取消",positiveText:"确定",onPositiveClick(){a()}}):a()},I=c({text:"",author:"",source:""}),R=m((()=>e.query.id));d((async()=>{const a=R.value;if(a&&"string"==typeof a){(a=>{T(I)(a)})((await C.api.says(a).get({})).data)}}));const q=async()=>{const a=()=>{try{if(!I.text||0==I.text.trim().length)throw"内容为空";return{...y(b(I),((a,e,t)=>(a[t]=void 0===e?null:"string"==typeof e&&0==e.length?"":e,a))),text:I.text.trim()}}catch(a){throw message.error(a),a}};if(R.value){if(!x(R.value))return;const e=R.value;await C.api.says(e).put({data:a()}),message.success("修改成功")}else await C.api.says.post({data:a()}),message.success("发布成功");t.push({name:P.ListSay})};return()=>p(j,{actionsElement:p(w,null,x(R)?p(g,{name:"更新",variant:"info",onClick:q,icon:p(a,null)}):p(w,null,p(g,{name:"发布一言",variant:"info",onClick:H,icon:p(L,null)}),p(g,{name:"发布自己说的",variant:"primary",onClick:q,icon:p(a,null)})))},p(f,null,p(h,{label:"内容",required:!0,labelPlacement:"left",labelStyle:{width:"4rem"}},p(v,{type:"textarea",autofocus:!0,autosize:{minRows:6,maxRows:8},placeholder:s.value.text,value:I.text,onInput:a=>{I.text=a}})),p(h,{label:"作者",labelPlacement:"left",labelStyle:{width:"4rem"}},p(v,{placeholder:s.value.author,value:I.author,onInput:a=>{I.author=a}})),p(h,{label:"来源",labelPlacement:"left",labelStyle:{width:"4rem"}},p(v,{placeholder:s.value.source,value:I.source,onInput:a=>{I.source=a}}))))}});export{R as default};
//# sourceMappingURL=edit-26e435fb-5d40d8f.js.map
