import{E as a,M as e,P as l,S as t}from"./parse-button-e8f1f215-2583105.js";import{T as s}from"./TelegramPlane-8578bc05-2583105.js";import{d as u,ae as n,o,aV as i,l as r,r as m,G as c,u as d,h as p,b0 as v,b1 as b,b2 as g,b3 as y,a$ as h,b4 as f,y as w,b5 as j,F as x,I as U,b6 as V,b7 as C}from"./vendor-75cb99ca-2583105.js";import{H as I}from"./rounded-button-48f84cf1-2583105.js";import"./monaco-07485367-2583105.js";import{U as k}from"./underline-input-abd63508-2583105.js";import{u as P,R as E,B as T,a as W,C as $,d as q}from"./index-2583105.js";import"./vue.runtime.esm-bundler-39cb0435-2583105.js";const z=u((()=>{const z=n(),A=P($);o((async()=>{await A.fetch()}));const B=i({categoryId:null!=(G=null==(F=null==(S=A.data)?void 0:S.value)?void 0:F[0].id)?G:"",slug:"",text:"",title:"",copyright:!0,tags:[],hide:!1,summary:""});var S,F,G;const H=r((()=>z.query.id)),M=r((()=>{var a,e;return A.get(B.categoryId)||(null==(e=null==(a=A.data)?void 0:a.value)?void 0:e[0])||{}}));o((async()=>{const a=H.value;if(a&&"string"==typeof a){(a=>{const e=V(B),l=Object.keys(e);for(const t in a)l.includes(t)&&(B[t]=a[t])})((await E.api.posts(a).get()).data)}}));const O=m(!1),R=c(),D=d(),J=async()=>{if(H.value){if(!C(H.value))return;const a=H.value;await E.api.posts(a).put({data:{...V(B),summary:B.summary&&""!=B.summary.trim()?B.summary.trim():null}}),R.success("修改成功")}else await E.api.posts.post({data:{...V(B),summary:""==B.summary.trim()?null:B.summary.trim()}}),R.success("发布成功");D.push({name:q.ViewPost,hash:"|publish"})};return()=>{var n;return p(W,{title:H.value?"修改文章":"撰写新文章",actionsElement:p(x,null,p(l,{data:B}),p(I,{icon:p(s,null),onClick:J})),footerButtonElement:p(x,null,p("button",{onClick:()=>{O.value=!0}},p(U,null,p(t,null))))},p(e,{class:"mt-3 relative z-10",label:"想想取个什么标题好呢~",value:B.title,onChange:a=>{B.title=a}}),p("div",{class:"text-gray-500 py-3"},p("label",{class:"prefix"},`${T}/${M.value.slug}/`),p(k,{class:"ml-2",value:B.slug,onChange:a=>{B.slug=a}})),p(a,{loading:!(!H.value||B.title),onChange:a=>{B.text=a},text:B.text}),p(v,{show:O.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:a=>{O.value=a}},p(b,{title:"文章设定"},p(g,null,p(y,{label:"分类",required:!0,path:"category"},p(h,{placeholder:"请选择",value:B.categoryId,onUpdateValue:a=>{B.categoryId=a},options:(null==(n=A.data.value)?void 0:n.map((a=>({label:a.name,value:a.id,key:a.id}))))||[]})),p(y,{label:"标签"},p(f,{value:B.tags,onUpdateValue:a=>{B.tags.length=0,B.tags.push(...a)}},{input({submit:a}){const e=u({setup(){const e=m([]),l=m(!1),t=m("");return o((async()=>{l.value=!0;const{data:a}=await E.api.categories.get({params:{type:"Tag"}});e.value=a.map((a=>({label:a.name+" ("+a.count+")",value:a.name,key:a.name}))),l.value=!1})),()=>p(h,{size:"small",value:t.value,clearable:!0,loading:l.value,filterable:!0,tag:!0,options:e.value,remote:!0,onUpdateValue:e=>{t.value=e,a(e)}})}});return p(e,null)}})),p(y,{label:"概要"},p(w,{placeholder:"文章概要",value:B.summary,onInput:a=>{B.summary=a}})),p(y,{label:"隐藏",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(j,{value:B.hide,onUpdateValue:a=>{B.hide=a}})),p(y,{label:"版权注明",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(j,{value:B.copyright,onUpdateValue:a=>{B.copyright=a}}))))))}}));export{z as default};
//# sourceMappingURL=write-8cedeb25-2583105.js.map
