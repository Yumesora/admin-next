import{E as a,M as e,P as l,S as t}from"./parse-button-bae36ae4-db6f513.js";import{T as s}from"./TelegramPlane-269fe073-db6f513.js";import{d as u,ab as n,o,aT as i,k as r,r as d,B as m,l as c,h as b,a$ as p,b0 as v,b1 as g,b2 as f,aZ as h,b3 as y,a_ as j,b4 as w,F as x,I as C,b5 as I,b6 as U}from"./vendor-33d8e755-db6f513.js";import{H as k}from"./rounded-button-4bead53b-db6f513.js";import"./monaco-8fed2e27-db6f513.js";import{U as P}from"./underline-input-e781a03c-db6f513.js";import{u as V,R as B,B as E,a as T,C as W,d as $}from"./index-db6f513.js";import"./vue.runtime.esm-bundler-f3471be9-db6f513.js";const q=u((()=>{const u=n(),q=V(W);o((async()=>{await q.fetch()}));const A=i({categoryId:null!=(F=null==(z=null==(S=q.data)?void 0:S.value)?void 0:z[0].id)?F:"",slug:"",text:"",title:"",copyright:!0,tags:[],hide:!1,summary:""});var S,z,F;const H=r((()=>u.query.id)),M=r((()=>{var a,e;return q.get(A.categoryId)||(null==(e=null==(a=q.data)?void 0:a.value)?void 0:e[0])||{}}));o((async()=>{const a=H.value;if(a&&"string"==typeof a){(a=>{const e=I(A),l=Object.keys(e);for(const t in a)l.includes(t)&&(A[t]=a[t])})((await B.api.posts(a).get()).data)}}));const O=d(!1),R=m(),Z=c(),_=async()=>{if(H.value){if(!U(H.value))return;const a=H.value;await B.api.posts(a).put({data:{...I(A),summary:A.summary&&""!=A.summary.trim()?A.summary.trim():null}}),R.success("修改成功")}else await B.api.posts.post({data:{...I(A),summary:""==A.summary.trim()?null:A.summary.trim()}}),R.success("发布成功");Z.push({name:$.ViewPost,hash:"|publish"})};return()=>{var u;return b(T,{title:H.value?"修改文章":"撰写新文章",actionsElement:b(x,null,b(l,{data:A}),b(k,{icon:b(s,null),onClick:_})),footerButtonElement:b(x,null,b("button",{onClick:()=>{O.value=!0}},b(C,null,b(t,null))))},b(e,{class:"mt-3 relative z-10",label:"想想取个什么标题好呢~",value:A.title,onChange:a=>{A.title=a}}),b("div",{class:"text-gray-500 py-3"},b("label",{class:"prefix"},`${E}/${M.value.slug}/`),b(P,{class:"ml-2",value:A.slug,onChange:a=>{A.slug=a}})),b(a,{loading:!(!H.value||A.title),onChange:a=>{A.text=a},text:A.text}),b(p,{show:O.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:a=>{O.value=a}},b(v,{title:"文章设定"},b(g,null,b(f,{label:"分类",required:!0,path:"category"},b(h,{placeholder:"请选择",value:A.categoryId,onUpdateValue:a=>{A.categoryId=a},options:(null==(u=q.data.value)?void 0:u.map((a=>({label:a.name,value:a.id,key:a.id}))))||[]})),b(f,{label:"标签"},b(y,{value:A.tags,onUpdateValue:a=>{A.tags.length=0,A.tags.push(...a)}})),b(f,{label:"概要"},b(j,{placeholder:"文章概要",value:A.summary,onInput:a=>{A.summary=a}})),b(f,{label:"隐藏",labelWidth:100,labelAlign:"right",labelPlacement:"left"},b(w,{value:A.hide,onUpdateValue:a=>{A.hide=a}})),b(f,{label:"版权注明",labelWidth:100,labelAlign:"right",labelPlacement:"left"},b(w,{value:A.copyright,onUpdateValue:a=>{A.copyright=a}}))))))}}));export{q as default};
//# sourceMappingURL=write-2c6cb5d7-db6f513.js.map
