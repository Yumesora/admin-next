import{P as e}from"./Plus-763526ea-cdc6fad.js";import{H as t}from"./rounded-button-a3f52ade-cdc6fad.js";import{T as n}from"./index-d3bc55c0-cdc6fad.js";import{u as r}from"./use-table-0cc3cbbe-cdc6fad.js";import{R as a,d as o,a as i}from"./index-cdc6fad.js";import{bc as l,br as u,bs as c,bt as d,b5 as s,d as f,ab as v,l as y,r as p,B as b,w as m,A as g,h as j,ba as O,Q as P,a$ as w,b0 as h,aY as _,aX as S,G as M,J as x,o as I,bp as k,aU as K,bn as C,bo as A,W as N,O as B,F as $,b3 as T}from"./vendor-154818d5-cdc6fad.js";import{r as V}from"./vue.runtime.esm-bundler-17dc0266-cdc6fad.js";var z,F,E,D;(F=z||(z={}))[F.Friend=0]="Friend",F[F.Collection=1]="Collection",(D=E||(E={}))[D.Pass=0]="Pass",D[D.Audit=1]="Audit";var R={},q={},U={};Object.defineProperty(U,"__esModule",{value:!0}),U.getSlot=void 0,U.getSlot=function(e,t="default",n=[]){const r=e.$slots[t];return void 0===r?n:r()};var H={};Object.defineProperty(H,"__esModule",{value:!0}),H.getVNodeChildren=void 0,H.getVNodeChildren=function(e,t="default",n=[]){const{children:r}=e;if(null!==r&&"object"==typeof r&&!Array.isArray(r)){const e=r[t];if("function"==typeof e)return e()}return n};var L={};Object.defineProperty(L,"__esModule",{value:!0}),L.keep=void 0,L.keep=function(e,t=[],n){const r={};return t.forEach((t=>{r[t]=e[t]})),Object.assign(r,n)};var W={};Object.defineProperty(W,"__esModule",{value:!0}),W.omit=void 0,W.omit=function(e,t=[],n){const r={};return Object.getOwnPropertyNames(e).forEach((n=>{t.includes(n)||(r[n]=e[n])})),Object.assign(r,n)};var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.flatten=void 0;const J=V;G.flatten=function e(t,n=!0,r=[]){return t.forEach((t=>{if(null!==t)if("object"==typeof t)if(Array.isArray(t))e(t,n,r);else if(t.type===J.Fragment){if(null===t.children)return;Array.isArray(t.children)&&e(t.children,n,r)}else t.type!==J.Comment&&r.push(t);else"string"!=typeof t&&"number"!=typeof t||r.push((0,J.createTextVNode)(String(t)))})),r};var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.call=void 0,Q.call=function e(t,...n){if(!Array.isArray(t))return t(...n);t.forEach((t=>e(t,...n)))};var X={};Object.defineProperty(X,"__esModule",{value:!0}),X.keysOf=void 0,X.keysOf=function(e){return Object.keys(e)};var Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.render=void 0;const Z=V;Y.render=(e,...t)=>"function"==typeof e?e(...t):"string"==typeof e?(0,Z.createTextVNode)(e):"number"==typeof e?(0,Z.createTextVNode)(String(e)):null;var ee={},te={},ne={};Object.defineProperty(ne,"__esModule",{value:!0}),ne.throwError=ne.warn=ne.warnOnce=void 0;const re=new Set;ne.warnOnce=function(e,t){const n=`[naive/${e}]: ${t}`;re.has(n)||(re.add(n),console.error(n))},ne.warn=function(e,t){console.error(`[naive/${e}]: ${t}`)},ne.throwError=function(e,t){throw new Error(`[naive/${e}]: ${t}`)};var ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.smallerSize=ae.largerSize=void 0,ae.largerSize=function(e){switch(e){case"tiny":return"small";case"small":return"medium";case"medium":return"large";case"large":return"huge"}},ae.smallerSize=function(e){switch(e){case"small":return"tiny";case"medium":return"small";case"large":return"medium";case"huge":return"large"}};var oe={};Object.defineProperty(oe,"__esModule",{value:!0}),oe.getTitleAttribute=void 0,oe.getTitleAttribute=function(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getTitleAttribute=e.largerSize=e.smallerSize=e.throwError=e.warnOnce=e.warn=void 0;var t=ne;Object.defineProperty(e,"warn",{enumerable:!0,get:function(){return t.warn}}),Object.defineProperty(e,"warnOnce",{enumerable:!0,get:function(){return t.warnOnce}}),Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return t.throwError}});var n=ae;Object.defineProperty(e,"smallerSize",{enumerable:!0,get:function(){return n.smallerSize}}),Object.defineProperty(e,"largerSize",{enumerable:!0,get:function(){return n.largerSize}});var r=oe;Object.defineProperty(e,"getTitleAttribute",{enumerable:!0,get:function(){return r.getTitleAttribute}})}(te),Object.defineProperty(ee,"__esModule",{value:!0}),ee.getFirstSlotVNode=void 0;const ie=G,le=te;ee.getFirstSlotVNode=function(e,t="default",n){const r=e[t];if(!r)return(0,le.warn)("getFirstSlotVNode",`slot[${t}] is empty`),null;const a=(0,ie.flatten)(r(n));return 1===a.length?a[0]:((0,le.warn)("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)};var ue={};Object.defineProperty(ue,"__esModule",{value:!0}),ue.createDataKey=void 0,ue.createDataKey=function(e){return"string"==typeof e?`s-${e}`:`n-${e}`};var ce={};Object.defineProperty(ce,"__esModule",{value:!0}),ce.createRefSetter=void 0,ce.createRefSetter=function(e){return t=>{e.value=t?t.$el:null}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createRefSetter=e.createDataKey=e.getFirstSlotVNode=e.render=e.keysOf=e.call=e.flatten=e.omit=e.keep=e.getVNodeChildren=e.getSlot=void 0;var t=U;Object.defineProperty(e,"getSlot",{enumerable:!0,get:function(){return t.getSlot}});var n=H;Object.defineProperty(e,"getVNodeChildren",{enumerable:!0,get:function(){return n.getVNodeChildren}});var r=L;Object.defineProperty(e,"keep",{enumerable:!0,get:function(){return r.keep}});var a=W;Object.defineProperty(e,"omit",{enumerable:!0,get:function(){return a.omit}});var o=G;Object.defineProperty(e,"flatten",{enumerable:!0,get:function(){return o.flatten}});var i=Q;Object.defineProperty(e,"call",{enumerable:!0,get:function(){return i.call}});var l=X;Object.defineProperty(e,"keysOf",{enumerable:!0,get:function(){return l.keysOf}});var u=Y;Object.defineProperty(e,"render",{enumerable:!0,get:function(){return u.render}});var c=ee;Object.defineProperty(e,"getFirstSlotVNode",{enumerable:!0,get:function(){return c.getFirstSlotVNode}});var d=ue;Object.defineProperty(e,"createDataKey",{enumerable:!0,get:function(){return d.createDataKey}});var s=ce;Object.defineProperty(e,"createRefSetter",{enumerable:!0,get:function(){return s.createRefSetter}})}(q);var de={},se={};Object.defineProperty(se,"__esModule",{value:!0});const fe=/^(\d|\.)+$/,ve=/(\d|\.)+/;se.default=function(e,{c:t=1,offset:n=0,attachPx:r=!0}={}){if("number"==typeof e){const r=(e+n)*t;return 0===r?"0":`${r}px`}if("string"==typeof e){if(fe.test(e)){const a=(Number(e)+n)*t;return r?0===a?"0":`${a}px`:`${a}`}{const r=ve.exec(e);return r?e.replace(ve,String((Number(r[0])+n)*t)):e}}return e},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLength=void 0;var t=se;Object.defineProperty(e,"formatLength",{enumerable:!0,get:function(){return t.default}})}(de);var ye={},pe=l(u),be=l(c),me={};function ge(e,t){return e+("default"===t?"":t.replace(/^[a-z]/,(e=>e.toUpperCase())))}Object.defineProperty(me,"__esModule",{value:!0}),me.createKey=void 0,me.createKey=ge,ge("abc","def"),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createKey=e.find=e.namespace=e.prefix=e.asModal=e.insidePopover=e.insideModal=e.insideFormItem=e.cCB=e.cNotM=e.cM=e.cE=e.cB=e.c=void 0;const t=pe,n=be;e.namespace="n";const r=".n-";e.prefix=r;const a=(0,t.default)(),o=(0,n.default)({blockPrefix:r,elementPrefix:"__",modifierPrefix:"--"});a.use(o);const{c:i,find:l}=a;e.c=i,e.find=l;const{cB:u,cE:c,cM:d,cNotM:s}=o;e.cB=u,e.cE=c,e.cM=d,e.cNotM=s,e.insideFormItem=function(e,t){return null===e?t:i([({props:{bPrefix:n}})=>i(`${n||r}form-item`,[i(`${n||r}form-item-blank`,[i(`&${n||r}form-item-blank--${e}`,[t])])])])},e.insideModal=function(e){return i((({props:{bPrefix:e}})=>`${e||r}modal, ${e||r}drawer`),[e])},e.insidePopover=function(e){return i((({props:{bPrefix:e}})=>`${e||r}popover:not(${e||r}tooltip)`),[e])},e.asModal=function(e){return i((({props:{bPrefix:e}})=>`&${e||r}modal`),e)};e.cCB=(...e)=>i(">",[u(...e)]);var f=me;Object.defineProperty(e,"createKey",{enumerable:!0,get:function(){return f.createKey}})}(ye);var je={},Oe={},Pe=l(d),we={};Object.defineProperty(we,"__esModule",{value:!0}),we.modalInjectionKey=we.modalBodyInjectionKey=void 0,we.modalBodyInjectionKey=Symbol("modalBody"),we.modalInjectionKey=Symbol("modal");var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.drawerInjectionKey=he.drawerBodyInjectionKey=void 0,he.drawerBodyInjectionKey=Symbol("drawerBody"),he.drawerInjectionKey=Symbol("drawer");var _e={};Object.defineProperty(_e,"__esModule",{value:!0}),_e.popoverBodyInjectionKey=void 0,_e.popoverBodyInjectionKey=Symbol("popoverBodyInjection");var Se={};Object.defineProperty(Se,"__esModule",{value:!0}),Se.internalSelectionMenuBodyInjectionKey=Se.internalSelectionMenuInjectionKey=void 0,Se.internalSelectionMenuInjectionKey=Symbol("internal-select-menu"),Se.internalSelectionMenuBodyInjectionKey=Symbol("internal-select-menu-body"),Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.useAdjustedTo=void 0;const Me=Pe,xe=V,Ie=we,ke=he,Ke=_e,Ce=Se;function Ae(e){const t=(0,xe.inject)(Ie.modalBodyInjectionKey,null),n=(0,xe.inject)(ke.drawerBodyInjectionKey,null),r=(0,xe.inject)(Ke.popoverBodyInjectionKey,null),a=(0,xe.inject)(Ce.internalSelectionMenuBodyInjectionKey,null);return(0,Me.useMemo)((()=>{var o;const{to:i}=e;return void 0!==i?!1===i?"__disabled__":!0===i?"body":i:(null==t?void 0:t.value)?null!==(o=t.value.$el)&&void 0!==o?o:t.value:(null==n?void 0:n.value)?n.value:(null==r?void 0:r.value)?r.value:(null==a?void 0:a.value)?a.value:null!=i?i:"body"}))}Oe.useAdjustedTo=Ae,Ae.tdkey="__disabled__",Ae.propTo={type:[String,Object,Boolean],default:void 0};var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.useHoudini=void 0;const Be=V;let $e=!1;Ne.useHoudini=function(){(0,Be.onBeforeMount)((()=>{var e;$e||($e=!0,(null===(e=null===window||void 0===window?void 0:window.CSS)||void 0===e?void 0:e.registerProperty)&&(CSS.registerProperty({name:"--color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})))}))},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useHoudini=e.useAdjustedTo=e.useDeferredTrue=e.useInjectionElementCollection=e.useInjectionCollection=e.useInjectionInstanceCollection=void 0;const t=V;e.useInjectionInstanceCollection=function(e,n,r){var a;const o=(0,t.inject)(e,null);if(null===o)return;const i=null===(a=(0,t.getCurrentInstance)())||void 0===a?void 0:a.proxy;function l(e,t){const r=o[n];void 0!==t&&function(e,t){e[t]||(e[t]=[]);e[t].splice(e[t].findIndex((e=>e===i)),1)}(r,t),void 0!==e&&function(e,t){e[t]||(e[t]=[]);~e[t].findIndex((e=>e===i))||e[t].push(i)}(r,e)}(0,t.watch)(r,l),l(r.value),(0,t.onBeforeUnmount)((()=>{l(void 0,r.value)}))},e.useInjectionCollection=function(e,n,r){const a=(0,t.inject)(e,null);null!==a&&(n in a||(a[n]=[]),a[n].push(r.value),(0,t.watch)(r,((e,t)=>{const r=a[n],o=r.findIndex((e=>e===t));~o&&r.splice(o,1),r.push(e)})),(0,t.onBeforeUnmount)((()=>{const e=a[n],t=e.findIndex((e=>e===r.value));~t&&e.splice(t,1)})))},e.useInjectionElementCollection=function(e,n,r){const a=(0,t.inject)(e,null);null!==a&&(n in a||(a[n]=[]),(0,t.onMounted)((()=>{const e=r();e&&a[n].push(e)})),(0,t.onBeforeUnmount)((()=>{const e=a[n],t=r(),o=e.findIndex((e=>e===t));~o&&e.splice(o,1)})))},e.useDeferredTrue=function(e,n,r){if(!n)return e;const a=(0,t.ref)(e.value);let o=null;return(0,t.watch)(e,(e=>{null!==o&&window.clearTimeout(o),!0===e?r&&!r.value?a.value=!0:o=window.setTimeout((()=>{a.value=!0}),n):a.value=!1})),a};var n=Oe;Object.defineProperty(e,"useAdjustedTo",{enumerable:!0,get:function(){return n.useAdjustedTo}});var r=Ne;Object.defineProperty(e,"useHoudini",{enumerable:!0,get:function(){return r.useHoudini}})}(je),function(e){var t=s&&s.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=s&&s.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.createKey=e.formatLength=e.getTitleAttribute=e.largerSize=e.smallerSize=e.throwError=e.warnOnce=e.warn=e.createRefSetter=e.createDataKey=e.getFirstSlotVNode=e.render=e.keysOf=e.getVNodeChildren=e.getSlot=e.flatten=e.omit=e.keep=e.call=void 0;var r=q;Object.defineProperty(e,"call",{enumerable:!0,get:function(){return r.call}}),Object.defineProperty(e,"keep",{enumerable:!0,get:function(){return r.keep}}),Object.defineProperty(e,"omit",{enumerable:!0,get:function(){return r.omit}}),Object.defineProperty(e,"flatten",{enumerable:!0,get:function(){return r.flatten}}),Object.defineProperty(e,"getSlot",{enumerable:!0,get:function(){return r.getSlot}}),Object.defineProperty(e,"getVNodeChildren",{enumerable:!0,get:function(){return r.getVNodeChildren}}),Object.defineProperty(e,"keysOf",{enumerable:!0,get:function(){return r.keysOf}}),Object.defineProperty(e,"render",{enumerable:!0,get:function(){return r.render}}),Object.defineProperty(e,"getFirstSlotVNode",{enumerable:!0,get:function(){return r.getFirstSlotVNode}}),Object.defineProperty(e,"createDataKey",{enumerable:!0,get:function(){return r.createDataKey}}),Object.defineProperty(e,"createRefSetter",{enumerable:!0,get:function(){return r.createRefSetter}});var a=te;Object.defineProperty(e,"warn",{enumerable:!0,get:function(){return a.warn}}),Object.defineProperty(e,"warnOnce",{enumerable:!0,get:function(){return a.warnOnce}}),Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return a.throwError}}),Object.defineProperty(e,"smallerSize",{enumerable:!0,get:function(){return a.smallerSize}}),Object.defineProperty(e,"largerSize",{enumerable:!0,get:function(){return a.largerSize}}),Object.defineProperty(e,"getTitleAttribute",{enumerable:!0,get:function(){return a.getTitleAttribute}});var o=de;Object.defineProperty(e,"formatLength",{enumerable:!0,get:function(){return o.formatLength}});var i=ye;Object.defineProperty(e,"createKey",{enumerable:!0,get:function(){return i.createKey}}),n(je,e)}(R);var Te=f({setup(){var l;const u=v(),c=y(),d=p(null!=(l=u.query.state)?l:E.Pass),{data:s,checkedRowKeys:V,fetchDataFn:F,pager:D,loading:q}=r(((e,t)=>async(n=u.query.page||1,r=50,o=(e=>null!=(e=u.query.state)?e:E.Pass)())=>{const i=await a.api.links.get({params:{page:n,size:r,state:0|o}});e.value=i.data,t.value=i.pagination})),U=b(),H=()=>({avatar:"",name:"",type:z.Friend,url:"",id:null,description:""}),L=p(!1),W=p(H());m((()=>u.query.state),(async e=>{await F()})),m((()=>u.query.page),(async e=>{await F()}),{immediate:!0});const G=p(0);g((async()=>{const e=await a.api.links.state.get();G.value=e.audit}));const J=async()=>{const e=W.value.id;if(W.value.id,e){await a.api.links(e).put({data:R.omit(W.value,["id"])});const t=s.value.findIndex((t=>t.id==e));s.value[t]={...s.value[t],...T(W.value)}}else{const{data:e}=await a.api.links.post({data:{...W.value}});s.value.unshift(e)}U.success("操作成功"),W.value=H(),L.value=!1};return()=>j(i,{actionsElement:j($,null,j(t,{icon:j(e,null),variant:"primary",onClick:()=>{W.value=H(),L.value=!0}}))},j(C,{size:"medium",value:d.value,onUpdateValue:e=>{d.value=e,c.replace({name:o.Friend,query:{state:e}})}},j(A,{name:E.Pass,tab:"朋友们"},j("div",{class:""})),j(A,{name:E.Audit,tab:()=>j(N,{value:G.value,processing:!0},j(B,null,"待审核"))},j("div",{class:""}))),j(n,{loading:q.value,data:s,nTableProps:{maxHeight:"calc(100vh - 22rem)"},columns:[{title:"头像",key:"avatar",render(e){const t=f((()=>{const t=p(!e.avatar);return I((()=>{if(e.avatar){const n=new Image;n.src=e.avatar,n.onload=e=>{t.value=!0}}})),()=>e.avatar&&t.value?j(k,{src:e.avatar,round:!0}):j(k,{round:!0},e.name.charAt(0))}));return j(t,null)}},{title:"名称",key:"name"},{title:"类型",key:"type",render:e=>["朋友","收藏"][0|e.type]},{title:"网址",key:"url",render:e=>j("a",{target:"_blank",href:e.url,rel:"noreferrer"},e.url)},{title:"描述",key:"description"},{title:"操作",fixed:"right",key:"id",render:e=>j(M,{wrap:!1},e.state==E.Audit&&j(x,{text:!0,size:"tiny",type:"success",onClick:async()=>{await a.api.links.audit(e.id).patch(),U.success("通过了来自"+e.name+"的友链邀请");const t=s.value.findIndex((t=>t.id==e.id));s.value.splice(t,1),G.value--}},"通过"),j(x,{text:!0,size:"tiny",type:"info",onClick:t=>{L.value=!0,W.value={...e}}},"编辑"),j(K,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await a.api.links(e.id).delete(),U.success("删除成功"),await F(D.value.currentPage)}},{trigger:()=>j(x,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>j("span",{style:{maxWidth:"12rem"}},"确定要删除友链 ",e.name," ?")}))}],onFetchData:F,pager:D}),j(O,{show:L.value,onUpdateShow:e=>{L.value=e}},j(P,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:W.value.id?"编辑: "+W.value.name:"新增"},j(w,null,j(h,{label:"名字",required:!0},j(_,{autofocus:!0,value:W.value.name,onInput:e=>{W.value.name=e}})),j(h,{label:"头像"},j(_,{autofocus:!0,value:W.value.avatar,onInput:e=>{W.value.avatar=e}})),j(h,{label:"网址",required:!0},j(_,{autofocus:!0,value:W.value.url,onInput:e=>{W.value.url=e}})),j(h,{label:"描述"},j(_,{autofocus:!0,value:W.value.description,onInput:e=>{W.value.description=e}})),j(h,{label:"类型"},j(S,{placeholder:"选择类型",options:[{label:"朋友",value:z.Friend},{label:"收藏",value:z.Collection}],value:W.value.type,onUpdateValue:e=>{W.value.type=0|e}}))),j("div",{class:"text-right"},j(M,{size:12,align:"center",inline:!0},j(x,{type:"success",onClick:J,round:!0},"确定"),j(x,{onClick:()=>{L.value=!1,W.value=H()},round:!0},"取消"))))))}});export{Te as default};
//# sourceMappingURL=index-f5f0473a-cdc6fad.js.map
