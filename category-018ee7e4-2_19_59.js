import{A as e}from"./Add12Filled-e850f595-2_19_59.js";import{H as a}from"./rounded-button-00a9564c-2_19_59.js";import{t}from"./index-348633d5-2_19_59.js";import{u as s,R as i,a as l,C as n}from"./index-2_19_59.js";import{d as r,aP as u,r as o,B as d,o as c,w as m,h as p,aU as g,aR as v,J as h,G as y,W as w,bd as b,C as f,aS as x,F as k,b9 as S,Q as _,aZ as C,be as z,aW as j}from"./vendor-a3bf3ad0-2_19_59.js";const A=r((r=>{const S=s(n),_=u([]),C=o(!0),z=S.fetch,j=d();c((async()=>{C.value=!0,await z(),C.value=!1;const{data:e}=await i.api.categories.get({params:{type:"tag"}});_.push(...e)}));const A=o(""),U=u([]);m((()=>A.value),(async e=>{const a=await i.api.categories(e).get({params:{tag:"true"}});U.length=0,U.push(...a.data)}));const W=o(!1),q=o({name:"",slug:""});return()=>p(l,{actionsElement:p(k,null,p(a,{variant:"success",icon:p(e,null),onClick:()=>{W.value=!0,q.value={name:"",slug:""}}}))},p(f,{prefix:"bar"},"分类"),p(I,{show:W,onSubmit:async e=>{const{name:a,slug:t}=e,s="string"==typeof W.value?W.value:null;if(s){await i.api.categories(s).put({data:{name:a,slug:t,type:0}}),j.success("修改成功");const l=S.data.value.findIndex((e=>e.id==s));S.data.value[l]={...S.data.value[l],...e}}else{const e=await i.api.categories.post({data:{name:a,slug:t}});j.success("创建成功"),S.data.value.push(e.data)}},initialState:q.value}),p(g,{rowClassName:()=>t,size:"small",bordered:!1,data:S.data.value||[],remote:!0,loading:C.value,columns:[{title:"名称",key:"name"},{title:"数",key:"count"},{title:"路径",key:"slug",width:300},{width:300,title:"操作",fixed:"right",key:"id",render:e=>p(y,{size:12},p(h,{size:"tiny",text:!0,type:"primary",onClick:a=>{q.value={name:e.name,slug:e.slug},W.value=e.id}},"编辑"),p(x,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await i.api.categories(e.id).delete(),j.success("删除成功"),await S.fetch(!0)}},{trigger:()=>p(h,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>p("span",{style:{maxWidth:"12rem"}},"确定要删除 ",e.title," ?")}))}]}),p(f,{prefix:"bar"},"标签"),p(y,{size:12},_.map((e=>p(w,{value:e.count,key:e.name},p(b,{class:"border-gray-200 border",round:!0,type:"success",checkable:!0,bordered:!0,checked:A.value==e.name,onUpdateChecked:a=>{A.value=a?e.name:""}},e.name))))),0!=U.length&&p(g,{remote:!0,class:"mt-4",data:U,columns:[{title:"标题",key:"title",render:e=>p(v,{to:"/posts/edit?id="+e.id},p(h,{type:"primary",text:!0},e.title))},{title:"分类",key:"category",render:e=>e.category.name}]}))})),I=r((e=>{var a;const t=u(null!=(a=e.initialState)?a:{name:"",slug:""});m((()=>e.initialState),(e=>{e&&(t.name=e.name,t.slug=e.slug)}));const s=d(),i=()=>{t.name&&t.slug?(e.onSubmit(t),e.show.value=!1):s.error("名字 和 路径 不能为空")};return()=>p(S,{show:!!e.show.value,onUpdateShow:a=>{e.show.value=a}},{default:()=>p(_,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:e.initialState?"编辑":"新建"},p(C,{onSubmit:i,rules:{name:{required:!0,trigger:["input","blur"]},slug:{required:!0,trigger:["input","blur"]}}},p(z,{path:"name",label:"名字"},p(j,{placeholder:"",onInput:e=>{t.name=e},value:t.name})),p(z,{path:"slug",label:"路径"},p(j,{placeholder:"",onInput:e=>{t.slug=e},value:t.slug})),p("div",{class:"text-center"},p(y,{size:12,align:"center",inline:!0},p(h,{type:"success",onClick:i,round:!0},"确定"),p(h,{onClick:()=>e.show.value=!1,round:!0},"取消")))))})}));I.props=["initialState","onSubmit","show"];export{A as CategoryView};
//# sourceMappingURL=category-018ee7e4-2_19_59.js.map
