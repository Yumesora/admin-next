import{d as e,b as t,e as a,f as r,B as o,aE as l,aa as i,w as s,o as n,aP as d,h as c,I as u,aR as p,bf as m,aS as w,J as h,G as v,F as f}from"./vendor-ab93f390-2c222dc.js";import{A as y}from"./Add12Filled-5bd173d2-2c222dc.js";import{D as g}from"./Delete16Regular-72592335-2c222dc.js";import{T as x}from"./index-0f402714-2c222dc.js";import{E as k}from"./edit-column-a7c315be-2c222dc.js";import{R as b}from"./relative-time-8aae25ce-2c222dc.js";import{u as C}from"./use-table-40ad1473-2c222dc.js";import{H as j}from"./rounded-button-84021239-2c222dc.js";import{R as B,a as O}from"./index-2c222dc.js";const z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 384 512"},D=r("path",{d:"M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400L0 512z",fill:"currentColor"},null,-1);var M=e({name:"Bookmark",render:function(e,r){return t(),a("svg",z,[D])}});const R={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},F=r("g",{fill:"none"},[r("path",{d:"M2.854 2.146a.5.5 0 1 0-.708.708l3.5 3.498a8.097 8.097 0 0 0-3.366 5.046a.5.5 0 1 0 .979.204a7.09 7.09 0 0 1 3.108-4.528L7.95 8.656a3.5 3.5 0 1 0 4.884 4.884l4.313 4.314a.5.5 0 0 0 .708-.708l-15-15z",fill:"currentColor"}),r("path",{d:"M10.124 8.003l3.363 3.363a3.5 3.5 0 0 0-3.363-3.363z",fill:"currentColor"}),r("path",{d:"M7.531 5.41l.803.803A6.632 6.632 0 0 1 10 6c3.206 0 6.057 2.327 6.74 5.602a.5.5 0 1 0 .98-.204C16.943 7.673 13.693 5 10 5c-.855 0-1.687.143-2.469.41z",fill:"currentColor"})],-1);var T=e({name:"EyeHide20Filled",render:function(e,r){return t(),a("svg",R,[F])}});const L=e({name:"NoteList",setup(){const{loading:t,checkedRowKeys:a,data:r,pager:z,sortProps:D,fetchDataFn:R}=C(((e,t)=>async(a=P.query.page||1,r=20)=>{const o=await B.api.notes.get({params:{page:a,size:r,select:"title _id id created modified mood weather hide secret hasMemory coordinates location",...D.sortBy?{sortBy:D.sortBy,sortOrder:D.sortOrder}:{}}});e.value=o.data,t.value=o.page})),F=o(),L=l(),P=i(),S=R;s((()=>P.query.page),(async e=>{await S(e)})),n((async()=>{await S()}));const A=e({setup(){const e=d([{type:"selection",options:["none","all"]},{title:"标题",sortOrder:!1,sorter:"default",key:"title",width:300,render:e=>c(p,{to:"/notes/edit?id="+e.id,class:"flex items-center space-x-2"},c("span",null,e.title),e.hide||e.secret&&+new Date(e.secret)-+new Date>0?c(u,{color:"#34495e"},c(T,null)):null,e.hasMemory?c(u,{color:"#e74c3c"},c(M,null)):null)},{title:"心情",key:"mood",width:100,render(e,t){var a;return c(k,{initialValue:null!=(a=r.value[t].mood)?a:"",onSubmit:async a=>{await B.api.notes(e.id).put({data:{mood:a}}),F.success("修改成功"),r.value[t].mood=a},placeholder:"心情"})}},{title:"天气",key:"weather",width:100,render(e,t){var a;return c(k,{initialValue:null!=(a=r.value[t].weather)?a:"",onSubmit:async a=>{await B.api.notes(e.id).put({data:{weather:a}}),F.success("修改成功"),r.value[t].weather=a},placeholder:"天气"})}},{title:"地点",key:"location",width:200,render(e){const{coordinates:t,location:a}=e;return a?c(m,{class:"truncate max-w-[200px]"},{tooltip:()=>c("div",{class:""},c("p",null,a),c("p",null,null==t?void 0:t.longitude,", ",null==t?void 0:t.latitude)),default:()=>a}):null}},{title:"创建于",key:"created",sortOrder:"descend",sorter:"default",width:200,render:e=>c(b,{time:e.created})},{title:"修改于",key:"modified",sorter:"default",sortOrder:!1,width:200,render:e=>c(b,{time:e.modified})},{title:"操作",key:"id",width:100,fixed:"right",render:e=>c(v,null,c(w,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await B.api.notes(e.id).delete(),F.success("删除成功"),await S(z.value.currentPage)}},{trigger:()=>c(h,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>c("span",{style:{maxWidth:"12rem"}},"确定要删除 ",e.title," ?")}))}]);return()=>c(x,{loading:t.value,columns:e,data:r,onFetchData:S,pager:z,onUpdateCheckedRowKeys:e=>{a.value=e},onUpdateSorter:async e=>{D.sortBy=e.sortBy,D.sortOrder=e.sortOrder}})}});return()=>c(O,null,{actions:()=>c(f,null,c(j,{variant:"error",disabled:0==a.value.length,onClick:()=>{L.warning({title:"警告",content:"你确定要删除？",positiveText:"确定",negativeText:"不确定",onPositiveClick:async()=>{for(const e of a.value)await B.api.notes(e).delete();a.value.length=0,F.success("删除成功"),await S()}})},icon:c(g,null)}),c(j,{to:"/notes/edit",icon:c(y,null)})),default:()=>c(A,null)})}});export{L as ManageNoteListView};
//# sourceMappingURL=list-55ae7bcb-2c222dc.js.map
