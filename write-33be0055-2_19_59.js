import{E as a,M as e,P as l,S as t}from"./parse-button-c0597c1d-2_19_59.js";import{T as s}from"./TelegramPlane-741a88f6-2_19_59.js";import{d as u,aa as n,o,aP as i,k as r,r as m,B as d,l as c,h as p,aX as v,aY as g,aZ as h,a_ as y,aV as b,a$ as f,aW as _,b0 as j,F as w,I as x,b1 as C,b2 as I}from"./vendor-a3bf3ad0-2_19_59.js";import{H as P}from"./rounded-button-00a9564c-2_19_59.js";import"./monaco-2cb49779-2_19_59.js";import{U}from"./underline-input-1dcccad1-2_19_59.js";import{u as V,R as k,B as W,a as B,C as E,e as $}from"./index-2_19_59.js";import"./vue.runtime.esm-bundler-dad87c3e-2_19_59.js";const q=u((()=>{const u=n(),q=V(E);o((async()=>{await q.fetch()}));const A=i({categoryId:null!=(z=null==(T=null==(S=q.data)?void 0:S.value)?void 0:T[0].id)?z:"",slug:"",text:"",title:"",copyright:!0,tags:[],hide:!1,summary:""});var S,T,z;const F=r((()=>u.query.id)),H=r((()=>{var a,e;return q.get(A.categoryId)||(null==(e=null==(a=q.data)?void 0:a.value)?void 0:e[0])||{}}));o((async()=>{const a=F.value;if(a&&"string"==typeof a){(a=>{const e=C(A),l=Object.keys(e);for(const t in a)l.includes(t)&&(A[t]=a[t])})((await k.api.posts(a).get()).data)}}));const M=m(!1),O=d(),R=c(),X=async()=>{if(F.value){if(!I(F.value))return;const a=F.value;await k.api.posts(a).put({data:{...C(A),summary:A.summary&&""!=A.summary.trim()?A.summary.trim():null}}),O.success("修改成功")}else await k.api.posts.post({data:{...C(A),summary:""==A.summary.trim()?null:A.summary.trim()}}),O.success("发布成功");R.push({name:$.ViewPost,hash:"|publish"})};return()=>{var u;return p(B,{title:F.value?"修改文章":"撰写新文章",actionsElement:p(w,null,p(l,{data:A}),p(P,{icon:p(s,null),onClick:X})),footerButtonElement:p(w,null,p("button",{onClick:()=>{M.value=!0}},p(x,null,p(t,null))))},p(e,{class:"mt-3 relative z-10",label:"想想取个什么标题好呢~",value:A.title,onChange:a=>{A.title=a}}),p("div",{class:"text-gray-500 py-3"},p("label",{class:"prefix"},`${W}/${H.value.slug}/`),p(U,{class:"ml-2",value:A.slug,onChange:a=>{A.slug=a}})),p(a,{loading:!(!F.value||A.title),onChange:a=>{A.text=a},text:A.text}),p(v,{show:M.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:a=>{M.value=a}},p(g,{title:"文章设定"},p(h,null,p(y,{label:"分类",required:!0,path:"category"},p(b,{placeholder:"请选择",value:A.categoryId,onUpdateValue:a=>{A.categoryId=a},options:(null==(u=q.data.value)?void 0:u.map((a=>({label:a.name,value:a.id,key:a.id}))))||[]})),p(y,{label:"标签"},p(f,{value:A.tags,onUpdateValue:a=>{A.tags.length=0,A.tags.push(...a)}})),p(y,{label:"概要"},p(_,{placeholder:"文章概要",value:A.summary,onInput:a=>{A.summary=a}})),p(y,{label:"隐藏",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(j,{value:A.hide,onUpdateValue:a=>{A.hide=a}})),p(y,{label:"版权注明",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(j,{value:A.copyright,onUpdateValue:a=>{A.copyright=a}}))))))}}));export default q;
//# sourceMappingURL=write-33be0055-2_19_59.js.map
