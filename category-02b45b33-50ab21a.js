import{A as a}from"./Add12Filled-dca729ac-50ab21a.js";import{H as e}from"./rounded-button-a3a7c1bf-50ab21a.js";import{t}from"./index-4a6aebcc-50ab21a.js";import{u as s,R as i,a as l,C as n}from"./index-50ab21a.js";import{d as r,aT as u,r as o,B as c,o as d,w as m,h as p,aY as g,aV as v,J as h,G as y,W as b,bg as w,C as x,aW as f,F as k,bc as S,Q as C,b1 as z,bh as j,a_ as A}from"./vendor-48a40c3c-50ab21a.js";const I=r((r=>{const S=s(n),C=u([]),z=o(!0),j=S.fetch,A=c();d((async()=>{z.value=!0,await j(),z.value=!1;const{data:a}=await i.api.categories.get({params:{type:"tag"}});C.push(...a)}));const I=o(""),W=u([]);m((()=>I.value),(async a=>{const e=await i.api.categories(a).get({params:{tag:"true"}});W.length=0,W.push(...e.data)}));const q=o(!1),F=o({name:"",slug:""});return()=>p(l,{actionsElement:p(k,null,p(e,{variant:"success",icon:p(a,null),onClick:()=>{q.value=!0,F.value={name:"",slug:""}}}))},p(x,{prefix:"bar"},"分类"),p(T,{show:q,onSubmit:async a=>{const{name:e,slug:t}=a,s="string"==typeof q.value?q.value:null;if(s){await i.api.categories(s).put({data:{name:e,slug:t,type:0}}),A.success("修改成功");const l=S.data.value.findIndex((a=>a.id==s));S.data.value[l]={...S.data.value[l],...a}}else{const a=await i.api.categories.post({data:{name:e,slug:t}});A.success("创建成功"),S.data.value.push(a.data)}},initialState:F.value}),p(g,{rowClassName:()=>t,size:"small",bordered:!1,data:S.data.value||[],remote:!0,loading:z.value,columns:[{title:"名称",key:"name"},{title:"数",key:"count"},{title:"路径",key:"slug",width:300},{width:300,title:"操作",fixed:"right",key:"id",render:a=>p(y,{size:12},p(h,{size:"tiny",text:!0,type:"primary",onClick:e=>{F.value={name:a.name,slug:a.slug},q.value=a.id}},"编辑"),p(f,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await i.api.categories(a.id).delete(),A.success("删除成功"),await S.fetch(!0)}},{trigger:()=>p(h,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>p("span",{style:{maxWidth:"12rem"}},"确定要删除 ",a.title," ?")}))}]}),p(x,{prefix:"bar"},"标签"),p(y,{size:12},C.map((a=>p(b,{value:a.count,key:a.name},p(w,{class:"border-gray-200 border",round:!0,type:"success",checkable:!0,bordered:!0,checked:I.value==a.name,onUpdateChecked:e=>{I.value=e?a.name:""}},a.name))))),0!=W.length&&p(g,{remote:!0,class:"mt-4",data:W,columns:[{title:"标题",key:"title",render:a=>p(v,{to:"/posts/edit?id="+a.id},p(h,{type:"primary",text:!0},a.title))},{title:"分类",key:"category",render:a=>a.category.name}]}))})),T=r((a=>{var e;const t=u(null!=(e=a.initialState)?e:{name:"",slug:""});m((()=>a.initialState),(a=>{a&&(t.name=a.name,t.slug=a.slug)}));const s=c(),i=()=>{t.name&&t.slug?(a.onSubmit(t),a.show.value=!1):s.error("名字 和 路径 不能为空")};return()=>p(S,{show:!!a.show.value,onUpdateShow:e=>{a.show.value=e}},{default:()=>p(C,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:a.initialState?"编辑":"新建"},p(z,{onSubmit:i,rules:{name:{required:!0,trigger:["input","blur"]},slug:{required:!0,trigger:["input","blur"]}}},p(j,{path:"name",label:"名字"},p(A,{placeholder:"",onInput:a=>{t.name=a},value:t.name})),p(j,{path:"slug",label:"路径"},p(A,{placeholder:"",onInput:a=>{t.slug=a},value:t.slug})),p("div",{class:"text-center"},p(y,{size:12,align:"center",inline:!0},p(h,{type:"success",onClick:i,round:!0},"确定"),p(h,{onClick:()=>a.show.value=!1,round:!0},"取消")))))})}));T.props=["initialState","onSubmit","show"];export{I as CategoryView};
//# sourceMappingURL=category-02b45b33-50ab21a.js.map
