import{E as h,M as v,P as f,S as E}from"./parse-button.js";import{T as w}from"./TelegramPlane.js";import{d as b,ag as y,aU as A,l as C,o as F,r as P,G as j,u as R,h as t,a_ as x,a$ as B,b0 as D,b1 as I,b8 as S,F as l,I as N,b5 as T,b4 as M}from"./vendor.js";import{H as U}from"./rounded-button.js";import{U as $}from"./underline-input.js";import{R as n,B as H,a as L,d as W}from"./index.js";import{u as k}from"./use-parse-payload.js";import"./use-react.js";import"./props.js";const X=b(()=>{const i=y(),d=()=>({text:"",title:"",order:0,slug:"",subtitle:""}),p=a=>k(e)(a),e=A(d()),s=C(()=>i.query.id);F(async()=>{const a=s.value;if(a&&typeof a=="string"){const g=(await n.api.pages(a).get({})).data;p(g)}});const u=P(!1),r=j(),c=R(),m=async()=>{const a=()=>{try{if(!e.title||e.title.trim().length==0)throw"\u6807\u9898\u4E3A\u7A7A";if(!e.slug)throw"\u8DEF\u5F84\u4E3A\u7A7A";return{...M(e),title:e.title.trim(),slug:e.slug.trim()}}catch(o){throw r.error(o),o}};if(s.value){if(!T(s.value))return;const o=s.value;await n.api.pages(o).put({data:a()}),r.success("\u4FEE\u6539\u6210\u529F")}else await n.api.pages.post({data:a()}),r.success("\u53D1\u5E03\u6210\u529F");c.push({name:W.ListPage,hash:"|publish"})};return()=>t(L,{actionsElement:t(l,null,t(f,{data:e}),t(U,{icon:t(w,null),onClick:m})),footerButtonElement:t(l,null,t("button",{onClick:()=>{u.value=!0}},t(N,null,t(E,null))))},t(v,{class:"mt-3 relative z-10",label:"\u4E0E\u4F60\u6709\u4E2A\u597D\u5FC3\u60C5~",value:e.title,onChange:a=>{e.title=a}}),t("div",{class:"text-gray-500 py-3"},t("label",null,`${H}/`),t($,{value:e.slug,onChange:a=>void(e.slug=a)})),t(h,{loading:!!(s.value&&!e.title),onChange:a=>{e.text=a},text:e.text}),t(x,{show:u.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:a=>{u.value=a}},t(B,{title:"\u6587\u7AE0\u8BBE\u5B9A"},t(D,null,t(I,{label:"\u9875\u9762\u987A\u5E8F"},t(S,{placeholder:"",value:e.order,onChange:a=>void(e.order=a??0)}))))))});export{X as default};
