import{E as v,M as b,P as f,S as E}from"./parse-button.js";import{T as w}from"./TelegramPlane.js";import{d as y,ag as C,aU as F,c as A,o as P,r as j,G as x,g as R,h as t,a$ as D,b0 as I,b1 as B,b2 as N,b9 as S,F as l,I as T,b6 as M,b5 as U}from"./vendor.js";import{H as W}from"./rounded-button.js";import{U as i}from"./underline-input.js";import{R as n,W as $,a as H,d as L}from"./index.js";import{u as k}from"./use-parse-payload.js";import"./use-react.js";import"./props.js";const X=y(()=>{const d=C(),p=()=>({text:"",title:"",order:0,slug:"",subtitle:""}),c=e=>k(a)(e),a=F(p()),s=A(()=>d.query.id);P(async()=>{const e=s.value;if(e&&typeof e=="string"){const h=(await n.api.pages(e).get({})).data;c(h)}});const u=j(!1),r=x(),m=R(),g=async()=>{const e=()=>{try{if(!a.title||a.title.trim().length==0)throw"\u6807\u9898\u4E3A\u7A7A";if(!a.slug)throw"\u8DEF\u5F84\u4E3A\u7A7A";return{...U(a),title:a.title.trim(),slug:a.slug.trim()}}catch(o){throw r.error(o),o}};if(s.value){if(!M(s.value))return;const o=s.value;await n.api.pages(o).put({data:e()}),r.success("\u4FEE\u6539\u6210\u529F")}else await n.api.pages.post({data:e()}),r.success("\u53D1\u5E03\u6210\u529F");m.push({name:L.ListPage,hash:"|publish"})};return()=>t(H,{actionsElement:t(l,null,t(f,{data:a}),t(W,{icon:t(w,null),onClick:g})),footerButtonElement:t(l,null,t("button",{onClick:()=>{u.value=!0}},t(T,null,t(E,null))))},t(b,{class:"mt-3 relative z-10",label:"\u4E0E\u4F60\u6709\u4E2A\u597D\u5FC3\u60C5~",value:a.title,onChange:e=>{a.title=e}}),t("div",{class:"text-gray-700 pt-3"},t(i,{value:a.subtitle,onChange:e=>void(a.subtitle=e)})),t("div",{class:"text-gray-500 py-3"},t("label",null,`${$}/`),t(i,{value:a.slug,onChange:e=>void(a.slug=e)})),t(v,{loading:!!(s.value&&!a.title),onChange:e=>{a.text=e},text:a.text}),t(D,{show:u.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:e=>{u.value=e}},t(I,{title:"\u6587\u7AE0\u8BBE\u5B9A"},t(B,null,t(N,{label:"\u9875\u9762\u987A\u5E8F"},t(S,{placeholder:"",value:a.order,onChange:e=>void(a.order=e??0)}))))))});export{X as default};
