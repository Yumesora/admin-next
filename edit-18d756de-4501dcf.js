import{T as e}from"./TelegramPlane-3de01f73-4501dcf.js";import{H as a}from"./rounded-button-6d40a7b5-4501dcf.js";import{M as l}from"./monaco-85588ab6-4501dcf.js";import{u as t}from"./use-parse-payload-2e717a3b-4501dcf.js";import{R as r,a as s,d as o}from"./index-4501dcf.js";import{d as n,af as c,u as i,aT as d,l as p,o as m,h as u,b0 as b,b1 as f,y as h,b2 as v,F as w,b5 as y,bM as j,b4 as g}from"./vendor-bf4cdcd7-4501dcf.js";import"./props-e8e03550-4501dcf.js";const x=n({setup(){const n=c(),x=i(),P=d({name:"",previewUrl:"",docUrl:"",projectUrl:"",images:[],description:"",avatar:"",text:""}),U=p((()=>n.query.id));m((async()=>{const e=U.value;if(e&&"string"==typeof e){(e=>{t(P)(e)})((await r.api.projects(e).get({})).data)}}));const S=async()=>{const e=()=>{try{if(!P.text||0==P.text.trim().length)throw"内容为空";return{...j(g(P),((e,a,l)=>(e[l]=void 0===a?null:"string"==typeof a&&0==a.length?"":a,e))),text:P.text.trim()}}catch(e){throw message.error(e),e}};if(U.value){if(!y(U.value))return;const a=U.value;await r.api.projects(a).put({data:e()}),message.success("修改成功")}else await r.api.projects.post({data:e()}),message.success("发布成功");x.push({name:o.ListProject})};return()=>u(s,{actionsElement:u(w,null,u(a,{variant:"primary",onClick:S,icon:u(e,null)}))},u(b,null,u(f,{label:"项目名称",required:!0,labelPlacement:"left",labelStyle:{width:"6rem"}},u(h,{autofocus:!0,placeholder:"",value:P.name,onInput:e=>{P.name=e}})),u(f,{label:"文档地址",labelPlacement:"left",labelStyle:{width:"6rem"}},u(h,{placeholder:"",value:P.docUrl,onInput:e=>{P.docUrl=e}})),u(f,{label:"预览地址",labelPlacement:"left",labelStyle:{width:"6rem"}},u(h,{placeholder:"",value:P.previewUrl,onInput:e=>{P.previewUrl=e}})),u(f,{label:"项目地址",labelPlacement:"left",labelStyle:{width:"6rem"}},u(h,{placeholder:"",value:P.projectUrl,onInput:e=>{P.projectUrl=e}})),u(f,{label:"项目描述",required:!0,labelPlacement:"left",labelStyle:{width:"6rem"}},u(h,{placeholder:"",value:P.description,onInput:e=>{P.description=e}})),u(f,{label:"项目图标",labelPlacement:"left",labelStyle:{width:"6rem"}},u(h,{placeholder:"",value:P.avatar,onInput:e=>{P.avatar=e}})),u(f,{label:"项目图标",labelPlacement:"left",labelStyle:{width:"6rem"}},u(v,{value:P.images,onUpdateValue:e=>{P.images=e}})),u(f,{label:"正文",required:!0,labelPlacement:"left"},u(l,{onChange:e=>{P.text=e},text:P.text,class:"h-40 w-full",unSaveConfirm:!1}))))}});export{x as default};
