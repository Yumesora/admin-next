import{A as k}from"./Add12Filled.js";import{D as S}from"./Delete16Regular.js";import{T as B}from"./index3.js";import{R as P}from"./relative-time.js";import{u as C}from"./use-table.js";import{R as F,p as T,d as $,a as z}from"./index.js";import{d as b,G as I,z as N,af as L,w as U,o as M,aT as O,h as o,Q as H,aV as K,A as x,B as Q,aW as V,F as W}from"./vendor.js";import{H as j}from"./rounded-button.js";function _(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_=function(r){return typeof r}:_=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_(e)}function w(e){var t=typeof e=="string"||e instanceof String;if(!t){var r=_(e);throw e===null?r="null":r==="object"&&(r=e.constructor.name),new TypeError("Expected a string but received a ".concat(r))}}function D(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var r in t)typeof e[r]=="undefined"&&(e[r]=t[r]);return e}var G={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1};function Z(e,t){w(e),t=D(t,G),t.allow_trailing_dot&&e[e.length-1]==="."&&(e=e.substring(0,e.length-1));var r=e.split("."),i=r[r.length-1];return t.require_tld&&(r.length<2||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(i)||/[\s\u2002-\u200B\u202F\u205F\u3000\uFEFF\uDB40\uDC20\u00A9\uFFFD]/.test(i))||!t.allow_numeric_tld&&/^\d+$/.test(i)?!1:r.every(function(u){return!(u.length>63||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(u)||/[\uff01-\uff5e]/.test(u)||/^-|-$/.test(u)||!t.allow_underscores&&/_/.test(u))})}var R="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",d="(".concat(R,"[.]){3}").concat(R),J=new RegExp("^".concat(d,"$")),n="(?:[0-9a-fA-F]{1,4})",X=new RegExp("^("+"(?:".concat(n,":){7}(?:").concat(n,"|:)|")+"(?:".concat(n,":){6}(?:").concat(d,"|:").concat(n,"|:)|")+"(?:".concat(n,":){5}(?::").concat(d,"|(:").concat(n,"){1,2}|:)|")+"(?:".concat(n,":){4}(?:(:").concat(n,"){0,1}:").concat(d,"|(:").concat(n,"){1,3}|:)|")+"(?:".concat(n,":){3}(?:(:").concat(n,"){0,2}:").concat(d,"|(:").concat(n,"){1,4}|:)|")+"(?:".concat(n,":){2}(?:(:").concat(n,"){0,3}:").concat(d,"|(:").concat(n,"){1,5}|:)|")+"(?:".concat(n,":){1}(?:(:").concat(n,"){0,4}:").concat(d,"|(:").concat(n,"){1,6}|:)|")+"(?::((?::".concat(n,"){0,5}:").concat(d,"|(?::").concat(n,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function h(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(w(e),t=String(t),!t)return h(e,4)||h(e,6);if(t==="4"){if(!J.test(e))return!1;var r=e.split(".").sort(function(i,u){return i-u});return r[3]<=255}return t==="6"?!!X.test(e):!1}var Y={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,validate_length:!0},ee=/^\[([^\]]+)\](?::([0-9]+))?$/;function te(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function A(e,t){for(var r=0;r<t.length;r++){var i=t[r];if(e===i||te(i)&&i.test(e))return!0}return!1}function re(e,t){if(w(e),!e||/[\s<>]/.test(e)||e.indexOf("mailto:")===0||(t=D(t,Y),t.validate_length&&e.length>=2083))return!1;var r,i,u,m,g,l,a,c;if(a=e.split("#"),e=a.shift(),a=e.split("?"),e=a.shift(),a=e.split("://"),a.length>1){if(r=a.shift().toLowerCase(),t.require_valid_protocol&&t.protocols.indexOf(r)===-1)return!1}else{if(t.require_protocol)return!1;if(e.substr(0,2)==="//"){if(!t.allow_protocol_relative_urls)return!1;a[0]=e.substr(2)}}if(e=a.join("://"),e==="")return!1;if(a=e.split("/"),e=a.shift(),e===""&&!t.require_host)return!0;if(a=e.split("@"),a.length>1&&(t.disallow_auth||a[0]===""||a[0].substr(0,1)===":"||(i=a.shift(),i.indexOf(":")>=0&&i.split(":").length>2)))return!1;m=a.join("@"),l=null,c=null;var f=m.match(ee);if(f?(u="",c=f[1],l=f[2]||null):(a=m.split(":"),u=a.shift(),a.length&&(l=a.join(":"))),l!==null){if(g=parseInt(l,10),!/^[0-9]+$/.test(l)||g<=0||g>65535)return!1}else if(t.require_port)return!1;return!(!h(u)&&!Z(u,t)&&(!c||!h(c,6))||(u=u||c,t.host_whitelist&&!A(u,t.host_whitelist))||t.host_blacklist&&A(u,t.host_blacklist))}const ce=b({setup(e,t){const{checkedRowKeys:r,data:i,pager:u,sortProps:m,fetchDataFn:g}=C((p,s)=>async(v=c.query.page||1,y=30)=>{const E=await F.api.projects.get({params:{page:v,size:y}});p.value=E.data,s.value=E.pagination}),l=I(),a=N(),c=L(),f=g;U(()=>c.query.page,async p=>{await f(p)}),M(async()=>{await f()});const q=b({setup(){const p=O([{type:"selection",options:["none","all"]},{title:"\u9879\u76EE\u540D\u79F0",key:"name",width:100,render(s){const v=[s.previewUrl,s.projectUrl,s.docUrl].filter(Boolean).find(y=>re(y,{require_protocol:!0}));return v?o("a",{href:v,target:"_blank",rel:"noreferrer"},s.name):o(H,null,s.name)}},{title:"\u9879\u76EE\u63CF\u8FF0",key:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"created",render(s){return T(s.created)}},{title:"\u4FEE\u6539\u4E8E",key:"created",render(s){return o(P,{time:s.created})}},{title:"\u64CD\u4F5C",fixed:"right",key:"id",width:130,render(s){return o(Q,{wrap:!1},o(K,{to:{name:$.EditProject,query:{id:s.id}}},o(x,{text:!0,type:"primary",size:"tiny"},"\u7F16\u8F91")),o(V,{positiveText:"\u53D6\u6D88",negativeText:"\u5220\u9664",onNegativeClick:async()=>{await F.api.projects(s.id).delete(),l.success("\u5220\u9664\u6210\u529F"),await f(u.value.currentPage)}},{trigger:()=>o(x,{text:!0,type:"error",size:"tiny"},"\u79FB\u9664"),default:()=>o("span",{style:{maxWidth:"12rem"}},"\u786E\u5B9A\u8981\u5220\u9664\u9879\u76EE [",s.name,"] ?")}))}}]);return()=>o(B,{columns:p,data:i,onFetchData:f,pager:u,onUpdateCheckedRowKeys:s=>{r.value=s}})}});return()=>o(z,null,{actions:()=>o(W,null,o(j,{variant:"error",disabled:r.value.length==0,onClick:()=>{a.warning({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:async()=>{for(const p of r.value)await F.api.projects(p).delete();r.value.length=0,l.success("\u5220\u9664\u6210\u529F"),await f()}})},icon:o(S,null)}),o(j,{to:"/projects/edit",icon:o(k,null)})),default:()=>o(q,null)})}});export{ce as default};
