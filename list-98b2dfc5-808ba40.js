import{d as e,b as t,aU as a,ai as r,G as l,z as n,ae as o,w as i,o as s,aV as d,h as u,I as c,aX as p,bi as w,ar as m,aY as v,A as f,B as h,F as g}from"./vendor-d4b9fdd0-808ba40.js";import{A as y}from"./Add12Filled-c436ee0c-808ba40.js";import{D as x}from"./Delete16Regular-1f33a701-808ba40.js";import{T as k}from"./index-0fa9d3f5-808ba40.js";import{E as b}from"./edit-column-b820c587-808ba40.js";import{R as C}from"./relative-time-4113be6a-808ba40.js";import{u as B}from"./use-table-67be1dfa-808ba40.js";import{H as j}from"./rounded-button-3013cdfd-808ba40.js";import{R as z,a as M}from"./index-808ba40.js";const O={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 384 512"},D=r("path",{d:"M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400L0 512z",fill:"currentColor"},null,-1);var F=e({name:"Bookmark",render:function(e,r){return t(),a("svg",O,[D])}});const L={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},R=r("path",{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z",fill:"currentColor"},null,-1);var T=e({name:"Heart",render:function(e,r){return t(),a("svg",L,[R])}});const A={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},V=r("g",{fill:"none"},[r("path",{d:"M2.854 2.146a.5.5 0 1 0-.708.708l3.5 3.498a8.097 8.097 0 0 0-3.366 5.046a.5.5 0 1 0 .979.204a7.09 7.09 0 0 1 3.108-4.528L7.95 8.656a3.5 3.5 0 1 0 4.884 4.884l4.313 4.314a.5.5 0 0 0 .708-.708l-15-15z",fill:"currentColor"}),r("path",{d:"M10.124 8.003l3.363 3.363a3.5 3.5 0 0 0-3.363-3.363z",fill:"currentColor"}),r("path",{d:"M7.531 5.41l.803.803A6.632 6.632 0 0 1 10 6c3.206 0 6.057 2.327 6.74 5.602a.5.5 0 1 0 .98-.204C16.943 7.673 13.693 5 10 5c-.855 0-1.687.143-2.469.41z",fill:"currentColor"})],-1);var H=e({name:"EyeHide20Filled",render:function(e,r){return t(),a("svg",A,[V])}});const P=e({name:"NoteList",setup(){const{loading:t,checkedRowKeys:a,data:r,pager:O,sortProps:D,fetchDataFn:L}=B(((e,t)=>async(a=V.query.page||1,r=20)=>{const l=await z.api.notes.get({params:{page:a,size:r,select:"title _id id created modified mood weather hide secret hasMemory coordinates location count",...D.sortBy?{sortBy:D.sortBy,sortOrder:D.sortOrder}:{}}});e.value=l.data,t.value=l.pagination})),R=l(),A=n(),V=o(),P=L;i((()=>V.query.page),(async e=>{await P(e)})),s((async()=>{await P()}));const S=e({setup(){const e=d([{type:"selection",options:["none","all"]},{title:"标题",sortOrder:!1,sorter:"default",key:"title",width:300,render:e=>u(p,{to:"/notes/edit?id="+e.id,class:"flex items-center space-x-2"},u("span",null,e.title),e.hide||e.secret&&+new Date(e.secret)-+new Date>0?u(c,{color:"#34495e"},u(H,null)):null,e.hasMemory?u(c,{color:"#e74c3c"},u(F,null)):null)},{title:"心情",key:"mood",width:100,render(e,t){var a;return u(b,{initialValue:null!=(a=r.value[t].mood)?a:"",onSubmit:async a=>{await z.api.notes(e.id).put({data:{mood:a}}),R.success("修改成功"),r.value[t].mood=a},placeholder:"心情"})}},{title:"天气",key:"weather",width:100,render(e,t){var a;return u(b,{initialValue:null!=(a=r.value[t].weather)?a:"",onSubmit:async a=>{await z.api.notes(e.id).put({data:{weather:a}}),R.success("修改成功"),r.value[t].weather=a},placeholder:"天气"})}},{title:"地点",key:"location",width:200,render(e){const{coordinates:t,location:a}=e;return a?u(w,{class:"truncate max-w-[200px]"},{tooltip:()=>u("div",{class:""},u("p",null,a),u("p",null,null==t?void 0:t.longitude,", ",null==t?void 0:t.latitude)),default:()=>a}):null}},{title:()=>u(c,null,u(m,null)),key:"count.read",ellipsis:!0,render(e){var t;return(null==(t=e.count)?void 0:t.read)||0}},{title:()=>u(c,null,u(T,null)),ellipsis:!0,key:"count.like",render(e){var t;return(null==(t=e.count)?void 0:t.like)||0}},{title:"创建于",key:"created",sortOrder:"descend",sorter:"default",width:200,render:e=>u(C,{time:e.created})},{title:"修改于",key:"modified",sorter:"default",sortOrder:!1,width:200,render:e=>u(C,{time:e.modified})},{title:"操作",key:"id",width:100,fixed:"right",render:e=>u(h,null,u(v,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await z.api.notes(e.id).delete(),R.success("删除成功"),await P(O.value.currentPage)}},{trigger:()=>u(f,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>u("span",{style:{maxWidth:"12rem"}},"确定要删除 ",e.title," ?")}))}]);return()=>u(k,{loading:t.value,columns:e,data:r,onFetchData:P,pager:O,onUpdateCheckedRowKeys:e=>{a.value=e},onUpdateSorter:async e=>{D.sortBy=e.sortBy,D.sortOrder=e.sortOrder}})}});return()=>u(M,null,{actions:()=>u(g,null,u(j,{variant:"error",disabled:0==a.value.length,onClick:()=>{A.warning({title:"警告",content:"你确定要删除？",positiveText:"确定",negativeText:"不确定",onPositiveClick:async()=>{for(const e of a.value)await z.api.notes(e).delete();a.value.length=0,R.success("删除成功"),await P()}})},icon:u(x,null)}),u(j,{to:"/notes/edit",icon:u(y,null)})),default:()=>u(S,null)})}});export{P as ManageNoteListView};
