import{P as e}from"./Plus-f7186c08-2c222dc.js";import{H as t}from"./rounded-button-84021239-2c222dc.js";import{T as r}from"./index-0f402714-2c222dc.js";import{u as n}from"./use-table-40ad1473-2c222dc.js";import{R as a,e as o,a as i}from"./index-2c222dc.js";import{bb as l,bq as u,br as c,bs as d,b3 as s,d as f,aa as v,l as y,r as p,B as b,w as m,A as g,h as j,b9 as O,Q as P,aZ as w,a_ as _,aW as h,aV as S,G as M,J as x,o as I,bo as k,aS as K,bm as A,bn as C,W as N,O as V,F as $,b1 as B}from"./vendor-ab93f390-2c222dc.js";import{r as T}from"./vue.runtime.esm-bundler-ca8ebb6b-2c222dc.js";var z,F,E,D;(F=z||(z={}))[F.Friend=0]="Friend",F[F.Collection=1]="Collection",(D=E||(E={}))[D.Pass=0]="Pass",D[D.Audit=1]="Audit";var R={},q={},H={};Object.defineProperty(H,"__esModule",{value:!0}),H.getSlot=void 0,H.getSlot=function(e,t="default",r=[]){const n=e.$slots[t];return void 0===n?r:n()};var U={};Object.defineProperty(U,"__esModule",{value:!0}),U.getVNodeChildren=void 0,U.getVNodeChildren=function(e,t="default",r=[]){const{children:n}=e;if(null!==n&&"object"==typeof n&&!Array.isArray(n)){const e=n[t];if("function"==typeof e)return e()}return r};var L={};Object.defineProperty(L,"__esModule",{value:!0}),L.keep=void 0,L.keep=function(e,t=[],r){const n={};return t.forEach((t=>{n[t]=e[t]})),Object.assign(n,r)};var W={};Object.defineProperty(W,"__esModule",{value:!0}),W.omit=void 0,W.omit=function(e,t=[],r){const n={};return Object.getOwnPropertyNames(e).forEach((r=>{t.includes(r)||(n[r]=e[r])})),Object.assign(n,r)};var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.flatten=void 0;const J=T;G.flatten=function e(t,r=[]){return t.forEach((t=>{if(null!==t)if("object"==typeof t)if(Array.isArray(t))e(t,r);else if(t.type===J.Fragment){if(null===t.children)return;Array.isArray(t.children)&&e(t.children,r)}else r.push(t);else"string"!=typeof t&&"number"!=typeof t||r.push(J.createTextVNode(String(t)))})),r};var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.call=void 0,Q.call=function e(t,...r){if(!Array.isArray(t))return t(...r);t.forEach((t=>e(t,...r)))};var Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.keysOf=void 0,Z.keysOf=function(e){return Object.keys(e)};var X={};Object.defineProperty(X,"__esModule",{value:!0}),X.render=void 0;const Y=T;X.render=(e,...t)=>"function"==typeof e?e(...t):"string"==typeof e?Y.createTextVNode(e):"number"==typeof e?Y.createTextVNode(String(e)):null;var ee={},te={},re={};Object.defineProperty(re,"__esModule",{value:!0}),re.throwError=re.warn=re.warnOnce=void 0;const ne=new Set;re.warnOnce=function(e,t){const r=`[naive/${e}]: ${t}`;ne.has(r)||ne.add(r)},re.warn=function(e,t){console.error(`[naive/${e}]: ${t}`)},re.throwError=function(e,t){throw new Error(`[naive/${e}]: ${t}`)};var ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.smallerSize=ae.largerSize=void 0,ae.largerSize=function(e){switch(e){case"tiny":return"small";case"small":return"medium";case"medium":return"large";case"large":return"huge"}},ae.smallerSize=function(e){switch(e){case"small":return"tiny";case"medium":return"small";case"large":return"medium";case"huge":return"large"}};var oe={};Object.defineProperty(oe,"__esModule",{value:!0}),oe.getTitleAttribute=void 0,oe.getTitleAttribute=function(e){switch(typeof e){case"string":return e||void 0;case"number":return String(e);default:return}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getTitleAttribute=e.largerSize=e.smallerSize=e.throwError=e.warnOnce=e.warn=void 0;var t=re;Object.defineProperty(e,"warn",{enumerable:!0,get:function(){return t.warn}}),Object.defineProperty(e,"warnOnce",{enumerable:!0,get:function(){return t.warnOnce}}),Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return t.throwError}});var r=ae;Object.defineProperty(e,"smallerSize",{enumerable:!0,get:function(){return r.smallerSize}}),Object.defineProperty(e,"largerSize",{enumerable:!0,get:function(){return r.largerSize}});var n=oe;Object.defineProperty(e,"getTitleAttribute",{enumerable:!0,get:function(){return n.getTitleAttribute}})}(te),Object.defineProperty(ee,"__esModule",{value:!0}),ee.getFirstSlotVNode=void 0;const ie=G,le=te;ee.getFirstSlotVNode=function(e,t="default",r){const n=e[t];if(!n)return le.warn("getFirstSlotVNode",`slot[${t}] is empty`),null;const a=ie.flatten(n(r));return 1===a.length?a[0]:(le.warn("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)};var ue={};Object.defineProperty(ue,"__esModule",{value:!0}),ue.createDataKey=void 0,ue.createDataKey=function(e){return"string"==typeof e?`s-${e}`:`n-${e}`};var ce={};Object.defineProperty(ce,"__esModule",{value:!0}),ce.createRefSetter=void 0,ce.createRefSetter=function(e){return t=>{e.value=t?t.$el:null}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createRefSetter=e.createDataKey=e.getFirstSlotVNode=e.render=e.keysOf=e.call=e.flatten=e.omit=e.keep=e.getVNodeChildren=e.getSlot=void 0;var t=H;Object.defineProperty(e,"getSlot",{enumerable:!0,get:function(){return t.getSlot}});var r=U;Object.defineProperty(e,"getVNodeChildren",{enumerable:!0,get:function(){return r.getVNodeChildren}});var n=L;Object.defineProperty(e,"keep",{enumerable:!0,get:function(){return n.keep}});var a=W;Object.defineProperty(e,"omit",{enumerable:!0,get:function(){return a.omit}});var o=G;Object.defineProperty(e,"flatten",{enumerable:!0,get:function(){return o.flatten}});var i=Q;Object.defineProperty(e,"call",{enumerable:!0,get:function(){return i.call}});var l=Z;Object.defineProperty(e,"keysOf",{enumerable:!0,get:function(){return l.keysOf}});var u=X;Object.defineProperty(e,"render",{enumerable:!0,get:function(){return u.render}});var c=ee;Object.defineProperty(e,"getFirstSlotVNode",{enumerable:!0,get:function(){return c.getFirstSlotVNode}});var d=ue;Object.defineProperty(e,"createDataKey",{enumerable:!0,get:function(){return d.createDataKey}});var s=ce;Object.defineProperty(e,"createRefSetter",{enumerable:!0,get:function(){return s.createRefSetter}})}(q);var de={},se={};Object.defineProperty(se,"__esModule",{value:!0});const fe=/^(\d|\.)+$/,ve=/(\d|\.)+/;se.default=function(e,{c:t=1,offset:r=0,attachPx:n=!0}={}){if("number"==typeof e){const n=(e+r)*t;return 0===n?"0":`${n}px`}if("string"==typeof e){if(fe.test(e)){const a=(Number(e)+r)*t;return n?0===a?"0":`${a}px`:`${a}`}{const n=ve.exec(e);return n?e.replace(ve,String((Number(n[0])+r)*t)):e}}return e},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLength=void 0;var t=se;Object.defineProperty(e,"formatLength",{enumerable:!0,get:function(){return t.default}})}(de);var ye={},pe=l(u),be=l(c),me={};function ge(e,t){return e+("default"===t?"":t.replace(/^[a-z]/,(e=>e.toUpperCase())))}Object.defineProperty(me,"__esModule",{value:!0}),me.createKey=void 0,me.createKey=ge,ge("abc","def"),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createKey=e.find=e.namespace=e.prefix=e.asModal=e.insidePopover=e.insideModal=e.insideFormItem=e.cNotM=e.cM=e.cE=e.cB=e.c=void 0;const t=pe,r=be;e.namespace="n";const n=".n-";e.prefix=n;const a=t.default(),o=r.default({blockPrefix:n,elementPrefix:"__",modifierPrefix:"--"});a.use(o);const{c:i,find:l}=a;e.c=i,e.find=l;const{cB:u,cE:c,cM:d,cNotM:s}=o;e.cB=u,e.cE=c,e.cM=d,e.cNotM=s,e.insideFormItem=function(e,t){return null===e?t:i([({props:{bPrefix:r}})=>i(`${r||n}form-item`,[i(`${r||n}form-item-blank`,[i(`&${r||n}form-item-blank--${e}`,[t])])])])},e.insideModal=function(e){return i((({props:{bPrefix:e}})=>`${e||n}modal, ${e||n}drawer`),[e])},e.insidePopover=function(e){return i((({props:{bPrefix:e}})=>`${e||n}popover:not(${e||n}tooltip)`),[e])},e.asModal=function(e){return i((({props:{bPrefix:e}})=>`&${e||n}modal`),e)};var f=me;Object.defineProperty(e,"createKey",{enumerable:!0,get:function(){return f.createKey}})}(ye);var je={},Oe={},Pe=l(d),we={};Object.defineProperty(we,"__esModule",{value:!0}),we.modalInjectionKey=we.modalBodyInjectionKey=void 0,we.modalBodyInjectionKey=Symbol("modalBody"),we.modalInjectionKey=Symbol("modal");var _e={};Object.defineProperty(_e,"__esModule",{value:!0}),_e.drawerInjectionKey=_e.drawerBodyInjectionKey=void 0,_e.drawerBodyInjectionKey=Symbol("drawerBody"),_e.drawerInjectionKey=Symbol("drawer");var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.popoverBodyInjectionKey=void 0,he.popoverBodyInjectionKey=Symbol("popoverBodyInjection");var Se={};Object.defineProperty(Se,"__esModule",{value:!0}),Se.internalSelectionMenuBodyInjectionKey=Se.internalSelectionMenuInjectionKey=void 0,Se.internalSelectionMenuInjectionKey=Symbol("internal-select-menu"),Se.internalSelectionMenuBodyInjectionKey=Symbol("internal-select-menu-body"),Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.useAdjustedTo=void 0;const Me=Pe,xe=T,Ie=we,ke=_e,Ke=he,Ae=Se;function Ce(e){const t=xe.inject(Ie.modalBodyInjectionKey,null),r=xe.inject(ke.drawerBodyInjectionKey,null),n=xe.inject(Ke.popoverBodyInjectionKey,null),a=xe.inject(Ae.internalSelectionMenuBodyInjectionKey,null);return Me.useMemo((()=>{var o;const{to:i}=e;return void 0!==i?!1===i?"__disabled__":!0===i?"body":i:(null==t?void 0:t.value)?null!==(o=t.value.$el)&&void 0!==o?o:t.value:(null==r?void 0:r.value)?r.value:(null==n?void 0:n.value)?n.value:(null==a?void 0:a.value)?a.value:null!=i?i:"body"}))}Oe.useAdjustedTo=Ce,Ce.tdkey="__disabled__",Ce.propTo={type:[String,Object,Boolean],default:void 0};var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.useHoudini=void 0;const Ve=T;let $e=!1;Ne.useHoudini=function(){Ve.onBeforeMount((()=>{var e;$e||($e=!0,(null===(e=null===window||void 0===window?void 0:window.CSS)||void 0===e?void 0:e.registerProperty)&&(CSS.registerProperty({name:"--color-start",syntax:"<color>",inherits:!1,initialValue:"#0000"}),CSS.registerProperty({name:"--color-end",syntax:"<color>",inherits:!1,initialValue:"#0000"})))}))},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useHoudini=e.useAdjustedTo=e.useDeferredTrue=e.useInjectionElementCollection=e.useInjectionCollection=e.useInjectionInstanceCollection=void 0;const t=T;e.useInjectionInstanceCollection=function(e,r,n){var a;const o=t.inject(e,null);if(null===o)return;const i=null===(a=t.getCurrentInstance())||void 0===a?void 0:a.proxy;function l(e,t){const n=o[r];void 0!==t&&function(e,t){e[t]||(e[t]=[]);e[t].splice(e[t].findIndex((e=>e===i)),1)}(n,t),void 0!==e&&function(e,t){e[t]||(e[t]=[]);~e[t].findIndex((e=>e===i))||e[t].push(i)}(n,e)}t.watch(n,l),l(n.value),t.onBeforeUnmount((()=>{l(void 0,n.value)}))},e.useInjectionCollection=function(e,r,n){const a=t.inject(e,null);null!==a&&(r in a||(a[r]=[]),a[r].push(n.value),t.watch(n,((e,t)=>{const n=a[r],o=n.findIndex((e=>e===t));~o&&n.splice(o,1),n.push(e)})),t.onBeforeUnmount((()=>{const e=a[r],t=e.findIndex((e=>e===n.value));~t&&e.splice(t,1)})))},e.useInjectionElementCollection=function(e,r,n){const a=t.inject(e,null);null!==a&&(r in a||(a[r]=[]),t.onMounted((()=>{const e=n();e&&a[r].push(e)})),t.onBeforeUnmount((()=>{const e=a[r],t=n(),o=e.findIndex((e=>e===t));~o&&e.splice(o,1)})))},e.useDeferredTrue=function(e,r,n){if(!r)return e;const a=t.ref(e.value);let o=null;return t.watch(e,(e=>{null!==o&&window.clearTimeout(o),!0===e?n&&!n.value?a.value=!0:o=window.setTimeout((()=>{a.value=!0}),r):a.value=!1})),a};var r=Oe;Object.defineProperty(e,"useAdjustedTo",{enumerable:!0,get:function(){return r.useAdjustedTo}});var n=Ne;Object.defineProperty(e,"useHoudini",{enumerable:!0,get:function(){return n.useHoudini}})}(je),function(e){var t=s&&s.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=s&&s.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.createKey=e.formatLength=e.getTitleAttribute=e.largerSize=e.smallerSize=e.throwError=e.warnOnce=e.warn=e.createRefSetter=e.createDataKey=e.getFirstSlotVNode=e.render=e.keysOf=e.getVNodeChildren=e.getSlot=e.flatten=e.omit=e.keep=e.call=void 0;var n=q;Object.defineProperty(e,"call",{enumerable:!0,get:function(){return n.call}}),Object.defineProperty(e,"keep",{enumerable:!0,get:function(){return n.keep}}),Object.defineProperty(e,"omit",{enumerable:!0,get:function(){return n.omit}}),Object.defineProperty(e,"flatten",{enumerable:!0,get:function(){return n.flatten}}),Object.defineProperty(e,"getSlot",{enumerable:!0,get:function(){return n.getSlot}}),Object.defineProperty(e,"getVNodeChildren",{enumerable:!0,get:function(){return n.getVNodeChildren}}),Object.defineProperty(e,"keysOf",{enumerable:!0,get:function(){return n.keysOf}}),Object.defineProperty(e,"render",{enumerable:!0,get:function(){return n.render}}),Object.defineProperty(e,"getFirstSlotVNode",{enumerable:!0,get:function(){return n.getFirstSlotVNode}}),Object.defineProperty(e,"createDataKey",{enumerable:!0,get:function(){return n.createDataKey}}),Object.defineProperty(e,"createRefSetter",{enumerable:!0,get:function(){return n.createRefSetter}});var a=te;Object.defineProperty(e,"warn",{enumerable:!0,get:function(){return a.warn}}),Object.defineProperty(e,"warnOnce",{enumerable:!0,get:function(){return a.warnOnce}}),Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return a.throwError}}),Object.defineProperty(e,"smallerSize",{enumerable:!0,get:function(){return a.smallerSize}}),Object.defineProperty(e,"largerSize",{enumerable:!0,get:function(){return a.largerSize}}),Object.defineProperty(e,"getTitleAttribute",{enumerable:!0,get:function(){return a.getTitleAttribute}});var o=de;Object.defineProperty(e,"formatLength",{enumerable:!0,get:function(){return o.formatLength}});var i=ye;Object.defineProperty(e,"createKey",{enumerable:!0,get:function(){return i.createKey}}),r(je,e)}(R);var Be=f({setup(){var l;const u=v(),c=y(),d=p(null!=(l=u.query.state)?l:E.Pass),{data:s,checkedRowKeys:T,fetchDataFn:F,pager:D,loading:q}=n(((e,t)=>async(r=u.query.page||1,n=50,o=(e=>null!=(e=u.query.state)?e:E.Pass)())=>{const i=await a.api.links.get({params:{page:r,size:n,state:0|o}});e.value=i.data,t.value=i.page})),H=b(),U=()=>({avatar:"",name:"",type:z.Friend,url:"",id:null,description:""}),L=p(!1),W=p(U());m((()=>u.query.state),(async e=>{await F()})),m((()=>u.query.page),(async e=>{await F()}),{immediate:!0});const G=p(0);g((async()=>{const e=await a.api.links.state.get();G.value=e.audit}));const J=async()=>{const e=W.value.id;if(W.value.id,e){await a.api.links(e).put({data:R.omit(W.value,["id"])});const t=s.value.findIndex((t=>t.id==e));s.value[t]={...s.value[t],...B(W.value)}}else{const{data:e}=await a.api.links.post({data:{...W.value}});s.value.unshift(e)}H.success("操作成功"),W.value=U(),L.value=!1};return()=>j(i,{actionsElement:j($,null,j(t,{icon:j(e,null),variant:"primary",onClick:()=>{W.value=U(),L.value=!0}}))},j(A,{size:"medium",value:d.value,onUpdateValue:e=>{d.value=e,c.replace({name:o.Friend,query:{state:e}})}},j(C,{name:E.Pass,tab:"朋友们"},j("div",{class:""})),j(C,{name:E.Audit,tab:()=>j(N,{value:G.value,processing:!0},j(V,null,"待审核"))},j("div",{class:""}))),j(r,{loading:q.value,data:s,nTableProps:{virtualScroll:!0,maxHeight:"calc(100vh - 22rem)"},columns:[{title:"头像",key:"avatar",render(e){const t=f((()=>{const t=p(!e.avatar);return I((()=>{if(e.avatar){const r=new Image;r.src=e.avatar,r.onload=e=>{t.value=!0}}})),()=>e.avatar&&t.value?j(k,{src:e.avatar,round:!0}):j(k,{round:!0},e.name.charAt(0))}));return j(t,null)}},{title:"名称",key:"name"},{title:"类型",key:"type",render:e=>["朋友","收藏"][0|e.type]},{title:"网址",key:"url",render:e=>j("a",{target:"_blank",href:e.url,rel:"noreferrer"},e.url)},{title:"描述",key:"description"},{title:"操作",fixed:"right",key:"id",render:e=>j(M,{wrap:!1},e.state==E.Audit&&j(x,{text:!0,size:"tiny",type:"success",onClick:async()=>{await a.api.links.audit(e.id).patch(),H.success("通过了来自"+e.name+"的友链邀请");const t=s.value.findIndex((t=>t.id==e.id));s.value.splice(t,1),G.value--}},"通过"),j(x,{text:!0,size:"tiny",type:"info",onClick:t=>{L.value=!0,W.value={...e}}},"编辑"),j(K,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await a.api.links(e.id).delete(),H.success("删除成功"),await F(D.value.currentPage)}},{trigger:()=>j(x,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>j("span",{style:{maxWidth:"12rem"}},"确定要删除友链 ",e.name," ?")}))}],onFetchData:F,pager:D}),j(O,{show:L.value,onUpdateShow:e=>{L.value=e}},j(P,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:W.value.id?"编辑: "+W.value.name:"新增"},j(w,null,j(_,{label:"名字",required:!0},j(h,{autofocus:!0,value:W.value.name,onInput:e=>{W.value.name=e}})),j(_,{label:"头像"},j(h,{autofocus:!0,value:W.value.avatar,onInput:e=>{W.value.avatar=e}})),j(_,{label:"网址",required:!0},j(h,{autofocus:!0,value:W.value.url,onInput:e=>{W.value.url=e}})),j(_,{label:"描述"},j(h,{autofocus:!0,value:W.value.description,onInput:e=>{W.value.description=e}})),j(_,{label:"类型"},j(S,{placeholder:"选择类型",options:[{label:"朋友",value:z.Friend},{label:"收藏",value:z.Collection}],value:W.value.type,onUpdateValue:e=>{W.value.type=0|e}}))),j("div",{class:"text-right"},j(M,{size:12,align:"center",inline:!0},j(x,{type:"success",onClick:J,round:!0},"确定"),j(x,{onClick:()=>{L.value=!1,W.value=U()},round:!0},"取消"))))))}});export{Be as default};
//# sourceMappingURL=index-363140b0-2c222dc.js.map
