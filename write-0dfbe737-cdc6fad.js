import{E as a,M as e,P as l,S as t}from"./parse-button-22310c24-cdc6fad.js";import{T as s}from"./TelegramPlane-aa411bf7-cdc6fad.js";import{d as u,ab as n,o,aR as i,k as r,r as d,B as c,l as m,h as p,aZ as v,a_ as g,a$ as b,b0 as f,aX as h,b1 as y,aY as j,b2 as w,F as x,I as C,b3 as I,b4 as U}from"./vendor-154818d5-cdc6fad.js";import{H as k}from"./rounded-button-a3f52ade-cdc6fad.js";import"./monaco-82e9cf8b-cdc6fad.js";import{U as P}from"./underline-input-50a0ef6b-cdc6fad.js";import{u as V,R as B,B as E,a as W,C as $,d as q}from"./index-cdc6fad.js";import"./vue.runtime.esm-bundler-17dc0266-cdc6fad.js";const A=u((()=>{const u=n(),A=V($);o((async()=>{await A.fetch()}));const R=i({categoryId:null!=(z=null==(T=null==(S=A.data)?void 0:S.value)?void 0:T[0].id)?z:"",slug:"",text:"",title:"",copyright:!0,tags:[],hide:!1,summary:""});var S,T,z;const F=r((()=>u.query.id)),H=r((()=>{var a,e;return A.get(R.categoryId)||(null==(e=null==(a=A.data)?void 0:a.value)?void 0:e[0])||{}}));o((async()=>{const a=F.value;if(a&&"string"==typeof a){(a=>{const e=I(R),l=Object.keys(e);for(const t in a)l.includes(t)&&(R[t]=a[t])})((await B.api.posts(a).get()).data)}}));const M=d(!1),O=c(),X=m(),Y=async()=>{if(F.value){if(!U(F.value))return;const a=F.value;await B.api.posts(a).put({data:{...I(R),summary:R.summary&&""!=R.summary.trim()?R.summary.trim():null}}),O.success("修改成功")}else await B.api.posts.post({data:{...I(R),summary:""==R.summary.trim()?null:R.summary.trim()}}),O.success("发布成功");X.push({name:q.ViewPost,hash:"|publish"})};return()=>{var u;return p(W,{title:F.value?"修改文章":"撰写新文章",actionsElement:p(x,null,p(l,{data:R}),p(k,{icon:p(s,null),onClick:Y})),footerButtonElement:p(x,null,p("button",{onClick:()=>{M.value=!0}},p(C,null,p(t,null))))},p(e,{class:"mt-3 relative z-10",label:"想想取个什么标题好呢~",value:R.title,onChange:a=>{R.title=a}}),p("div",{class:"text-gray-500 py-3"},p("label",{class:"prefix"},`${E}/${H.value.slug}/`),p(P,{class:"ml-2",value:R.slug,onChange:a=>{R.slug=a}})),p(a,{loading:!(!F.value||R.title),onChange:a=>{R.text=a},text:R.text}),p(v,{show:M.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:a=>{M.value=a}},p(g,{title:"文章设定"},p(b,null,p(f,{label:"分类",required:!0,path:"category"},p(h,{placeholder:"请选择",value:R.categoryId,onUpdateValue:a=>{R.categoryId=a},options:(null==(u=A.data.value)?void 0:u.map((a=>({label:a.name,value:a.id,key:a.id}))))||[]})),p(f,{label:"标签"},p(y,{value:R.tags,onUpdateValue:a=>{R.tags.length=0,R.tags.push(...a)}})),p(f,{label:"概要"},p(j,{placeholder:"文章概要",value:R.summary,onInput:a=>{R.summary=a}})),p(f,{label:"隐藏",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(w,{value:R.hide,onUpdateValue:a=>{R.hide=a}})),p(f,{label:"版权注明",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(w,{value:R.copyright,onUpdateValue:a=>{R.copyright=a}}))))))}}));export{A as default};
//# sourceMappingURL=write-0dfbe737-cdc6fad.js.map
