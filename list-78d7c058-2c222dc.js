import{A as t}from"./Add12Filled-5bd173d2-2c222dc.js";import{D as e}from"./Delete16Regular-72592335-2c222dc.js";import{T as r}from"./index-0f402714-2c222dc.js";import{R as n}from"./relative-time-8aae25ce-2c222dc.js";import{u as a}from"./use-table-40ad1473-2c222dc.js";import{R as o,p as i,e as c,a as l}from"./index-2c222dc.js";import{d as s,B as u,aE as f,aa as d,w as p,o as g,aP as h,h as v,O as _,aR as m,J as y,G as w,aS as b,F as j}from"./vendor-ab93f390-2c222dc.js";import{H as x}from"./rounded-button-84021239-2c222dc.js";function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t){if(!("string"==typeof t||t instanceof String)){var e=q(t);throw null===t?e="null":"object"===e&&(e=t.constructor.name),new TypeError("Expected a string but received a ".concat(e))}}function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;for(var r in e)void 0===t[r]&&(t[r]=e[r]);return t}var R={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1};var S="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",E="(".concat(S,"[.]){3}").concat(S),$=new RegExp("^".concat(E,"$")),z="(?:[0-9a-fA-F]{1,4})",D=new RegExp("^("+"(?:".concat(z,":){7}(?:").concat(z,"|:)|")+"(?:".concat(z,":){6}(?:").concat(E,"|:").concat(z,"|:)|")+"(?:".concat(z,":){5}(?::").concat(E,"|(:").concat(z,"){1,2}|:)|")+"(?:".concat(z,":){4}(?:(:").concat(z,"){0,1}:").concat(E,"|(:").concat(z,"){1,3}|:)|")+"(?:".concat(z,":){3}(?:(:").concat(z,"){0,2}:").concat(E,"|(:").concat(z,"){1,4}|:)|")+"(?:".concat(z,":){2}(?:(:").concat(z,"){0,3}:").concat(E,"|(:").concat(z,"){1,5}|:)|")+"(?:".concat(z,":){1}(?:(:").concat(z,"){0,4}:").concat(E,"|(:").concat(z,"){1,6}|:)|")+"(?::((?::".concat(z,"){0,5}:").concat(E,"|(?::").concat(z,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(k(t),!(e=String(e)))return C(t,4)||C(t,6);if("4"===e){if(!$.test(t))return!1;var r=t.split(".").sort((function(t,e){return t-e}));return r[3]<=255}return"6"===e&&!!D.test(t)}var T={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,validate_length:!0},A=/^\[([^\]]+)\](?::([0-9]+))?$/;function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];if(t===n||(a=n,"[object RegExp]"===Object.prototype.toString.call(a)&&n.test(t)))return!0}var a;return!1}function P(t,e){if(k(t),!t||/[\s<>]/.test(t))return!1;if(0===t.indexOf("mailto:"))return!1;if((e=F(e,T)).validate_length&&t.length>=2083)return!1;var r,n,a,o,i,c,l,s;if(l=t.split("#"),t=l.shift(),l=t.split("?"),t=l.shift(),(l=t.split("://")).length>1){if(r=l.shift().toLowerCase(),e.require_valid_protocol&&-1===e.protocols.indexOf(r))return!1}else{if(e.require_protocol)return!1;if("//"===t.substr(0,2)){if(!e.allow_protocol_relative_urls)return!1;l[0]=t.substr(2)}}if(""===(t=l.join("://")))return!1;if(l=t.split("/"),""===(t=l.shift())&&!e.require_host)return!0;if((l=t.split("@")).length>1){if(e.disallow_auth)return!1;if(""===l[0]||":"===l[0].substr(0,1))return!1;if((n=l.shift()).indexOf(":")>=0&&n.split(":").length>2)return!1}c=null,s=null;var u=(o=l.join("@")).match(A);if(u?(a="",s=u[1],c=u[2]||null):(a=(l=o.split(":")).shift(),l.length&&(c=l.join(":"))),null!==c){if(i=parseInt(c,10),!/^[0-9]+$/.test(c)||i<=0||i>65535)return!1}else if(e.require_port)return!1;return!!(C(a)||function(t,e){k(t),(e=F(e,R)).allow_trailing_dot&&"."===t[t.length-1]&&(t=t.substring(0,t.length-1));var r=t.split("."),n=r[r.length-1];if(e.require_tld){if(r.length<2)return!1;if(!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(n))return!1;if(/[\s\u2002-\u200B\u202F\u205F\u3000\uFEFF\uDB40\uDC20\u00A9\uFFFD]/.test(n))return!1}return!(!e.allow_numeric_tld&&/^\d+$/.test(n))&&r.every((function(t){return!(t.length>63||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(t)||/[\uff01-\uff5e]/.test(t)||/^-|-$/.test(t)||!e.allow_underscores&&/_/.test(t))}))}(a,e)||s&&C(s,6))&&(a=a||s,!(e.host_whitelist&&!O(a,e.host_whitelist))&&(!e.host_blacklist||!O(a,e.host_blacklist)))}const B=s({setup(q,k){const{checkedRowKeys:F,data:R,pager:S,sortProps:E,fetchDataFn:$}=a(((t,e)=>async(r=C.query.page||1,n=30)=>{const a=await o.api.projects.get({params:{page:r,size:n}});t.value=a.data,e.value=a.page})),z=u(),D=f(),C=d(),T=$;p((()=>C.query.page),(async t=>{await T(t)})),g((async()=>{await T()}));const A=s({setup(){const t=h([{type:"selection",options:["none","all"]},{title:"项目名称",key:"name",width:100,render(t){const e=[t.previewUrl,t.projectUrl,t.docUrl].filter(Boolean).find((t=>P(t,{require_protocol:!0})));return e?v("a",{href:e,target:"_blank",rel:"noreferrer"},t.name):v(_,null,t.name)}},{title:"项目描述",key:"description"},{title:"创建时间",key:"created",render:t=>i(t.created)},{title:"修改于",key:"created",render:t=>v(n,{time:t.created})},{title:"操作",fixed:"right",key:"id",width:130,render:t=>v(w,{wrap:!1},v(m,{to:{name:c.EditProject,query:{id:t.id}}},v(y,{text:!0,type:"primary",size:"tiny"},"编辑")),v(b,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await o.api.projects(t.id).delete(),z.success("删除成功"),await T(S.value.currentPage)}},{trigger:()=>v(y,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>v("span",{style:{maxWidth:"12rem"}},"确定要删除项目 [",t.name,"] ?")}))}]);return()=>v(r,{columns:t,data:R,onFetchData:T,pager:S,onUpdateCheckedRowKeys:t=>{F.value=t}})}});return()=>v(l,null,{actions:()=>v(j,null,v(x,{variant:"error",disabled:0==F.value.length,onClick:()=>{D.warning({title:"警告",content:"你确定要删除？",positiveText:"确定",negativeText:"不确定",onPositiveClick:async()=>{for(const t of F.value)await o.api.projects(t).delete();F.value.length=0,z.success("删除成功"),await T()}})},icon:v(e,null)}),v(x,{to:"/projects/edit",icon:v(t,null)})),default:()=>v(A,null)})}});export{B as default};
//# sourceMappingURL=list-78d7c058-2c222dc.js.map
