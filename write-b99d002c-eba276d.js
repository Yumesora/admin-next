import{E as a,M as e,P as l,S as t}from"./parse-button-5f651e5f-eba276d.js";import{T as s}from"./TelegramPlane-32b55e16-eba276d.js";import{d as u,aa as n,o,aP as i,k as r,r as d,B as m,l as c,h as p,aX as b,aY as v,aZ as g,a_ as h,aV as y,a$ as f,aW as j,b0 as w,F as x,I as C,b1 as I,b2 as P}from"./vendor-41cd395d-eba276d.js";import{H as U}from"./rounded-button-c440ca4c-eba276d.js";import"./monaco-f8b4e9be-eba276d.js";import{U as V}from"./underline-input-47d2e519-eba276d.js";import{u as k,R as W,B,a as E,C as $,e as q}from"./index-eba276d.js";import"./vue.runtime.esm-bundler-eddc0f25-eba276d.js";const A=u((()=>{const u=n(),A=k($);o((async()=>{await A.fetch()}));const S=i({categoryId:null!=(F=null==(z=null==(T=A.data)?void 0:T.value)?void 0:z[0].id)?F:"",slug:"",text:"",title:"",copyright:!0,tags:[],hide:!1,summary:""});var T,z,F;const H=r((()=>u.query.id)),M=r((()=>{var a,e;return A.get(S.categoryId)||(null==(e=null==(a=A.data)?void 0:a.value)?void 0:e[0])||{}}));o((async()=>{const a=H.value;if(a&&"string"==typeof a){(a=>{const e=I(S),l=Object.keys(e);for(const t in a)l.includes(t)&&(S[t]=a[t])})((await W.api.posts(a).get()).data)}}));const O=d(!1),R=m(),X=c(),Y=async()=>{if(H.value){if(!P(H.value))return;const a=H.value;await W.api.posts(a).put({data:{...I(S),summary:S.summary&&""!=S.summary.trim()?S.summary.trim():null}}),R.success("修改成功")}else await W.api.posts.post({data:{...I(S),summary:""==S.summary.trim()?null:S.summary.trim()}}),R.success("发布成功");X.push({name:q.ViewPost,hash:"|publish"})};return()=>{var u;return p(E,{title:H.value?"修改文章":"撰写新文章",actionsElement:p(x,null,p(l,{data:S}),p(U,{icon:p(s,null),onClick:Y})),footerButtonElement:p(x,null,p("button",{onClick:()=>{O.value=!0}},p(C,null,p(t,null))))},p(e,{class:"mt-3 relative z-10",label:"想想取个什么标题好呢~",value:S.title,onChange:a=>{S.title=a}}),p("div",{class:"text-gray-500 py-3"},p("label",{class:"prefix"},`${B}/${M.value.slug}/`),p(V,{class:"ml-2",value:S.slug,onChange:a=>{S.slug=a}})),p(a,{loading:!(!H.value||S.title),onChange:a=>{S.text=a},text:S.text}),p(b,{show:O.value,width:450,style:{maxWidth:"90vw"},placement:"right",onUpdateShow:a=>{O.value=a}},p(v,{title:"文章设定"},p(g,null,p(h,{label:"分类",required:!0,path:"category"},p(y,{placeholder:"请选择",value:S.categoryId,onUpdateValue:a=>{S.categoryId=a},options:(null==(u=A.data.value)?void 0:u.map((a=>({label:a.name,value:a.id,key:a.id}))))||[]})),p(h,{label:"标签"},p(f,{value:S.tags,onUpdateValue:a=>{S.tags.length=0,S.tags.push(...a)}})),p(h,{label:"概要"},p(j,{placeholder:"文章概要",value:S.summary,onInput:a=>{S.summary=a}})),p(h,{label:"隐藏",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(w,{value:S.hide,onUpdateValue:a=>{S.hide=a}})),p(h,{label:"版权注明",labelWidth:100,labelAlign:"right",labelPlacement:"left"},p(w,{value:S.copyright,onUpdateValue:a=>{S.copyright=a}}))))))}}));export{A as default};
//# sourceMappingURL=write-b99d002c-eba276d.js.map
